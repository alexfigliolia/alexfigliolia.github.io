var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n,i=(e,t)=>{for(var r in t||(t={}))s.call(t,r)&&o(e,r,t[r]);if(n)for(var r of n(t))a.call(t,r)&&o(e,r,t[r]);return e},A=(e,t)=>{var r={};for(var o in e)s.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&n)for(var o of n(e))t.indexOf(o)<0&&a.call(e,o)&&(r[o]=e[o]);return r},c=(e,t,r)=>(o(e,"symbol"!=typeof t?t+"":t,r),r),l=(e,t,r)=>new Promise(((n,s)=>{var a=e=>{try{i(r.next(e))}catch(t){s(t)}},o=e=>{try{i(r.throw(e))}catch(t){s(t)}},i=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,o);i((r=r.apply(e,t)).next())}));import{r as u}from"./index-V6KHFFTR.js";import{R as B,Z as d,$ as h,a0 as f,M as C,a1 as p,S as m,a2 as g,a3 as E,a4 as M,a5 as F,o as I,a6 as v,a7 as R,a8 as G,a9 as D,aa as y,V as w,i as b,h as H,ab as T,ac as x,ad as J,ae as S,af as O,e as U,ag as L,L as P,ah as _,ai as K,aj as N,ak as k,al as Q,f as X,am as j,B as Y,v as Z,an as W,ao as V,ap as q,aq as z,ar as $,k as ee,q as te,O as re,t as ne,as as se,w as ae,at as oe,Q as ie,au as Ae,av as ce,aw as le,ax as ue,ay as Be,az as de,aA as he,aB as fe,aC as Ce,aD as pe,aE as me,aF as ge,aG as Ee,K as Me,Y as Fe,aH as Ie,aI as ve,H as Re,J as Ge,aJ as De,aK as ye,aL as we,aM as be,c as He,aN as Te,b as xe,aO as Je,aP as Se,aQ as Oe,aR as Ue,aS as Le,aT as Pe,aU as _e,aV as Ke,aW as Ne,aX as ke,aY as Qe,x as Xe,N as je,a as Ye,aZ as Ze,a_ as We,a$ as Ve,W as qe,u as ze,b0 as $e,g as et,_ as tt,b1 as rt,b2 as nt}from"./index-DsY_2V6a.js";const st=(()=>parseInt(B.replace(/\D+/g,"")))();function at(e,t){if(t===d)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===h||t===f){let r=e.getIndex();if(null===r){const t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}const n=r.count-2,s=[];if(r)if(t===h)for(let e=1;e<=n;e++)s.push(r.getX(0)),s.push(r.getX(e)),s.push(r.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(s.push(r.getX(e)),s.push(r.getX(e+1)),s.push(r.getX(e+2))):(s.push(r.getX(e+2)),s.push(r.getX(e+1)),s.push(r.getX(e)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=e.clone();return a.setIndex(s),a.clearGroups(),a}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}var ot=Uint8Array,it=Uint16Array,At=Uint32Array,ct=new ot([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lt=new ot([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ut=new ot([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Bt=function(e,t){for(var r=new it(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var s=new At(r[30]);for(n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return[r,s]},dt=Bt(ct,2),ht=dt[0],ft=dt[1];ht[28]=258,ft[258]=28;for(var Ct=Bt(lt,0)[0],pt=new it(32768),mt=0;mt<32768;++mt){var gt=(43690&mt)>>>1|(21845&mt)<<1;gt=(61680&(gt=(52428&gt)>>>2|(13107&gt)<<2))>>>4|(3855&gt)<<4,pt[mt]=((65280&gt)>>>8|(255&gt)<<8)>>>1}var Et=function(e,t,r){for(var n=e.length,s=0,a=new it(t);s<n;++s)++a[e[s]-1];var o,i=new it(t);for(s=0;s<t;++s)i[s]=i[s-1]+a[s-1]<<1;if(r){o=new it(1<<t);var A=15-t;for(s=0;s<n;++s)if(e[s])for(var c=s<<4|e[s],l=t-e[s],u=i[e[s]-1]++<<l,B=u|(1<<l)-1;u<=B;++u)o[pt[u]>>>A]=c}else for(o=new it(n),s=0;s<n;++s)e[s]&&(o[s]=pt[i[e[s]-1]++]>>>15-e[s]);return o},Mt=new ot(288);for(mt=0;mt<144;++mt)Mt[mt]=8;for(mt=144;mt<256;++mt)Mt[mt]=9;for(mt=256;mt<280;++mt)Mt[mt]=7;for(mt=280;mt<288;++mt)Mt[mt]=8;var Ft=new ot(32);for(mt=0;mt<32;++mt)Ft[mt]=5;var It=Et(Mt,9,1),vt=Et(Ft,5,1),Rt=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Gt=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},Dt=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},yt=function(e,t,r){var n=e.length;if(!n||r&&!r.l&&n<5)return t||new ot(0);var s=!t||r,a=!r||r.i;r||(r={}),t||(t=new ot(3*n));var o,i=function(e){var r=t.length;if(e>r){var n=new ot(Math.max(2*r,e));n.set(t),t=n}},A=r.f||0,c=r.p||0,l=r.b||0,u=r.l,B=r.d,d=r.m,h=r.n,f=8*n;do{if(!u){r.f=A=Gt(e,c,1);var C=Gt(e,c+1,3);if(c+=3,!C){var p=e[(y=((o=c)/8|0)+(7&o&&1)+4)-4]|e[y-3]<<8,m=y+p;if(m>n){if(a)throw"unexpected EOF";break}s&&i(l+p),t.set(e.subarray(y,m),l),r.b=l+=p,r.p=c=8*m;continue}if(1==C)u=It,B=vt,d=9,h=5;else{if(2!=C)throw"invalid block type";var g=Gt(e,c,31)+257,E=Gt(e,c+10,15)+4,M=g+Gt(e,c+5,31)+1;c+=14;for(var F=new ot(M),I=new ot(19),v=0;v<E;++v)I[ut[v]]=Gt(e,c+3*v,7);c+=3*E;var R=Rt(I),G=(1<<R)-1,D=Et(I,R,1);for(v=0;v<M;){var y,w=D[Gt(e,c,G)];if(c+=15&w,(y=w>>>4)<16)F[v++]=y;else{var b=0,H=0;for(16==y?(H=3+Gt(e,c,3),c+=2,b=F[v-1]):17==y?(H=3+Gt(e,c,7),c+=3):18==y&&(H=11+Gt(e,c,127),c+=7);H--;)F[v++]=b}}var T=F.subarray(0,g),x=F.subarray(g);d=Rt(T),h=Rt(x),u=Et(T,d,1),B=Et(x,h,1)}if(c>f){if(a)throw"unexpected EOF";break}}s&&i(l+131072);for(var J=(1<<d)-1,S=(1<<h)-1,O=c;;O=c){var U=(b=u[Dt(e,c)&J])>>>4;if((c+=15&b)>f){if(a)throw"unexpected EOF";break}if(!b)throw"invalid length/literal";if(U<256)t[l++]=U;else{if(256==U){O=c,u=null;break}var L=U-254;if(U>264){var P=ct[v=U-257];L=Gt(e,c,(1<<P)-1)+ht[v],c+=P}var _=B[Dt(e,c)&S],K=_>>>4;if(!_)throw"invalid distance";c+=15&_;x=Ct[K];if(K>3){P=lt[K];x+=Dt(e,c)&(1<<P)-1,c+=P}if(c>f){if(a)throw"unexpected EOF";break}s&&i(l+131072);for(var N=l+L;l<N;l+=4)t[l]=t[l-x],t[l+1]=t[l+1-x],t[l+2]=t[l+2-x],t[l+3]=t[l+3-x];l=N}}r.l=u,r.p=O,r.b=l,u&&(A=1,r.m=d,r.d=B,r.n=h)}while(!A);return l==t.length?t:function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var n=new(e instanceof it?it:e instanceof At?At:ot)(r-t);return n.set(e.subarray(t,r)),n}(t,0,l)},wt=new ot(0);function bt(e,t){return yt((function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"}(e),e.subarray(2,-4)),t)}var Ht="undefined"!=typeof TextDecoder&&new TextDecoder;try{Ht.decode(wt,{stream:!0}),1}catch(Rn){}class Tt extends C{constructor(e,t){var r,n;const s=(a=e)&&a.isCubeTexture;var a;const o=(null!=(n=s?null==(r=e.image[0])?void 0:r.width:e.image.width)?n:1024)/4,i=Math.floor(Math.log2(o)),A=Math.pow(2,i),c=[s?"#define ENVMAP_TYPE_CUBE":"","#define CUBEUV_TEXEL_WIDTH "+1/(3*Math.max(A,112)),"#define CUBEUV_TEXEL_HEIGHT "+1/(4*A),`#define CUBEUV_MAX_MIP ${i}.0`].join("\n")+`\n        #define ENVMAP_TYPE_CUBE_UV\n        varying vec3 vWorldPosition;\n        uniform float radius;\n        uniform float height;\n        uniform float angle;\n        #ifdef ENVMAP_TYPE_CUBE\n            uniform samplerCube map;\n        #else\n            uniform sampler2D map;\n        #endif\n        // From: https://www.shadertoy.com/view/4tsBD7\n        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) \n        {\n            float d = dot ( rd, n );\n            \n            if( d > 0.0 ) { return 1e6; }\n            \n            vec3  o = ro - c;\n            float t = - dot( n, o ) / d;\n            vec3  q = o + rd * t;\n            \n            return ( dot( q, q ) < r * r ) ? t : 1e6;\n        }\n        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm\n        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) \n        {\n            vec3 oc = ro - ce;\n            float b = dot( oc, rd );\n            float c = dot( oc, oc ) - ra * ra;\n            float h = b * b - c;\n            \n            if( h < 0.0 ) { return -1.0; }\n            \n            h = sqrt( h );\n            \n            return - b + h;\n        }\n        vec3 project() \n        {\n            vec3 p = normalize( vWorldPosition );\n            vec3 camPos = cameraPosition;\n            camPos.y -= height;\n            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );\n            if( intersection > 0.0 ) {\n                \n                vec3 h = vec3( 0.0, - height, 0.0 );\n                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );\n                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;\n            } else {\n                p = vec3( 0.0, 1.0, 0.0 );\n            }\n            return p;\n        }\n        #include <common>\n        #include <cube_uv_reflection_fragment>\n        void main() \n        {\n            vec3 projectedWorldPosition = project();\n            \n            #ifdef ENVMAP_TYPE_CUBE\n                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;\n            #else\n                vec3 direction = normalize( projectedWorldPosition );\n                vec2 uv = equirectUv( direction );\n                vec3 outcolor = texture2D( map, uv ).rgb;\n            #endif\n            gl_FragColor = vec4( outcolor, 1.0 );\n            #include <tonemapping_fragment>\n            #include <${st>=154?"colorspace_fragment":"encodings_fragment"}>\n        }\n        `,l={map:{value:e},height:{value:(null==t?void 0:t.height)||15},radius:{value:(null==t?void 0:t.radius)||100}};super(new p(1,16),new m({uniforms:l,fragmentShader:c,vertexShader:"\n        varying vec3 vWorldPosition;\n        void main() \n        {\n            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );\n            vWorldPosition = worldPosition.xyz;\n            \n            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }\n        ",side:g}))}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}function xt(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(Rn){return t}}const Jt="srgb",St="srgb-linear";class Ot extends E{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new Nt(e)})),this.register((function(e){return new kt(e)})),this.register((function(e){return new zt(e)})),this.register((function(e){return new $t(e)})),this.register((function(e){return new er(e)})),this.register((function(e){return new Xt(e)})),this.register((function(e){return new jt(e)})),this.register((function(e){return new Yt(e)})),this.register((function(e){return new Zt(e)})),this.register((function(e){return new Kt(e)})),this.register((function(e){return new Wt(e)})),this.register((function(e){return new Qt(e)})),this.register((function(e){return new qt(e)})),this.register((function(e){return new Vt(e)})),this.register((function(e){return new Pt(e)})),this.register((function(e){return new tr(e)})),this.register((function(e){return new rr(e)}))}load(e,t,r,n){const s=this;let a;if(""!==this.resourcePath)a=this.resourcePath;else if(""!==this.path){const t=M.extractUrlBase(e);a=M.resolveURL(t,this.path)}else a=M.extractUrlBase(e);this.manager.itemStart(e);const o=function(t){n?n(t):console.error(t),s.manager.itemError(e),s.manager.itemEnd(e)},i=new F(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(r){try{s.parse(r,a,(function(r){t(r),s.manager.itemEnd(e)}),o)}catch(Rn){o(Rn)}}),r,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,n){let s;const a={},o={};if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer){if(xt(new Uint8Array(e.slice(0,4)))===nr){try{a[Lt.KHR_BINARY_GLTF]=new or(e)}catch(A){return void(n&&n(A))}s=JSON.parse(a[Lt.KHR_BINARY_GLTF].content)}else s=JSON.parse(xt(new Uint8Array(e)))}else s=e;if(void 0===s.asset||s.asset.version[0]<2)return void(n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const i=new Tr(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});i.fileLoader.setRequestHeader(this.requestHeader);for(let c=0;c<this.pluginCallbacks.length;c++){const e=this.pluginCallbacks[c](i);e.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[e.name]=e,a[e.name]=!0}if(s.extensionsUsed)for(let c=0;c<s.extensionsUsed.length;++c){const e=s.extensionsUsed[c],t=s.extensionsRequired||[];switch(e){case Lt.KHR_MATERIALS_UNLIT:a[e]=new _t;break;case Lt.KHR_DRACO_MESH_COMPRESSION:a[e]=new ir(s,this.dracoLoader);break;case Lt.KHR_TEXTURE_TRANSFORM:a[e]=new Ar;break;case Lt.KHR_MESH_QUANTIZATION:a[e]=new cr;break;default:t.indexOf(e)>=0&&void 0===o[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}i.setExtensions(a),i.setPlugins(o),i.parse(r,n)}parseAsync(e,t){const r=this;return new Promise((function(n,s){r.parse(e,t,n,s)}))}}function Ut(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const Lt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class Pt{constructor(e){this.parser=e,this.name=Lt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,n=t.length;r<n;r++){const n=t[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let n=t.cache.get(r);if(n)return n;const s=t.json,a=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let o;const i=new I(16777215);void 0!==a.color&&i.setRGB(a.color[0],a.color[1],a.color[2],St);const A=void 0!==a.range?a.range:0;switch(a.type){case"directional":o=new G(i),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new R(i),o.distance=A;break;case"spot":o=new v(i),o.distance=A,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,o.angle=a.spot.outerConeAngle,o.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return o.position.set(0,0,0),o.decay=2,Gr(o,a),void 0!==a.intensity&&(o.intensity=a.intensity),o.name=t.createUniqueName(a.name||"light_"+e),n=Promise.resolve(o),t.cache.add(r,n),n}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,n=r.json.nodes[e],s=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then((function(e){return r._getNodeRef(t.cache,s,e)}))}}class _t{constructor(){this.name=Lt.KHR_MATERIALS_UNLIT}getMaterialType(){return D}extendParams(e,t,r){const n=[];e.color=new I(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const t=s.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],St),e.opacity=t[3]}void 0!==s.baseColorTexture&&n.push(r.assignTexture(e,"map",s.baseColorTexture,Jt))}return Promise.all(n)}}class Kt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const n=r.extensions[this.name].emissiveStrength;return void 0!==n&&(t.emissiveIntensity=n),Promise.resolve()}}class Nt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&s.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(s.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new w(e,e)}return Promise.all(s)}}class kt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_DISPERSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const n=r.extensions[this.name];return t.dispersion=void 0!==n.dispersion?n.dispersion:0,Promise.resolve()}}class Qt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&s.push(r.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&s.push(r.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class Xt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new I(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=n.extensions[this.name];if(void 0!==a.sheenColorFactor){const e=a.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],St)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&s.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,Jt)),void 0!==a.sheenRoughnessTexture&&s.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class jt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&s.push(r.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class Yt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&s.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const o=a.attenuationColor||[1,1,1];return t.attenuationColor=(new I).setRGB(o[0],o[1],o[2],St),Promise.all(s)}}class Zt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const n=r.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}}class Wt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&s.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));const o=a.specularColorFactor||[1,1,1];return t.specularColor=(new I).setRGB(o[0],o[1],o[2],St),void 0!==a.specularColorTexture&&s.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,Jt)),Promise.all(s)}}class Vt{constructor(e){this.parser=e,this.name=Lt.EXT_MATERIALS_BUMP}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];return t.bumpScale=void 0!==a.bumpFactor?a.bumpFactor:1,void 0!==a.bumpTexture&&s.push(r.assignTexture(t,"bumpMap",a.bumpTexture)),Promise.all(s)}}class qt{constructor(e){this.parser=e,this.name=Lt.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?y:null}extendMaterialParams(e,t){const r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];return void 0!==a.anisotropyStrength&&(t.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(t.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&s.push(r.assignTexture(t,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}}class zt{constructor(e){this.parser=e,this.name=Lt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const s=n.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class $t{constructor(e){this.parser=e,this.name=Lt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],o=n.images[a.source];let i=r.textureLoader;if(o.uri){const e=r.options.manager.getHandler(o.uri);null!==e&&(i=e)}return this.detectSupport().then((function(s){if(s)return r.loadTextureImage(e,a.source,i);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class er{constructor(e){this.parser=e,this.name=Lt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],o=n.images[a.source];let i=r.textureLoader;if(o.uri){const e=r.options.manager.getHandler(o.uri);null!==e&&(i=e)}return this.detectSupport().then((function(s){if(s)return r.loadTextureImage(e,a.source,i);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class tr{constructor(e){this.name=Lt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const e=r.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then((function(t){const r=e.byteOffset||0,n=e.byteLength||0,a=e.count,o=e.byteStride,i=new Uint8Array(t,r,n);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(a,o,i,e.mode,e.filter).then((function(e){return e.buffer})):s.ready.then((function(){const t=new ArrayBuffer(a*o);return s.decodeGltfBuffer(new Uint8Array(t),a,o,i,e.mode,e.filter),t}))}))}return null}}class rr{constructor(e){this.name=Lt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;const n=t.meshes[r.mesh];for(const i of n.primitives)if(i.mode!==dr.TRIANGLES&&i.mode!==dr.TRIANGLE_STRIP&&i.mode!==dr.TRIANGLE_FAN&&void 0!==i.mode)return null;const s=r.extensions[this.name].attributes,a=[],o={};for(const i in s)a.push(this.parser.getDependency("accessor",s[i]).then((e=>(o[i]=e,o[i]))));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then((e=>{const t=e.pop(),r=t.isGroup?t.children:[t],n=e[0].count,s=[];for(const a of r){const e=new b,t=new H,r=new ie,i=new H(1,1,1),A=new T(a.geometry,a.material,n);for(let s=0;s<n;s++)o.TRANSLATION&&t.fromBufferAttribute(o.TRANSLATION,s),o.ROTATION&&r.fromBufferAttribute(o.ROTATION,s),o.SCALE&&i.fromBufferAttribute(o.SCALE,s),A.setMatrixAt(s,e.compose(t,r,i));for(const n in o)if("_COLOR_0"===n){const e=o[n];A.instanceColor=new x(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==n&&"ROTATION"!==n&&"SCALE"!==n&&a.geometry.setAttribute(n,o[n]);J.prototype.copy.call(A,a),this.parser.assignFinalMaterial(A),s.push(A)}return t.isGroup?(t.clear(),t.add(...s),t):s[0]})))}}const nr="glTF",sr=1313821514,ar=5130562;class or{constructor(e){this.name=Lt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:xt(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==nr)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,n=new DataView(e,12);let s=0;for(;s<r;){const t=n.getUint32(s,!0);s+=4;const r=n.getUint32(s,!0);if(s+=4,r===sr){const r=new Uint8Array(e,12+s,t);this.content=xt(r)}else if(r===ar){const r=12+s;this.body=e.slice(r,r+t)}s+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class ir{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Lt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,n=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},i={},A={};for(const c in a){const e=mr[c]||c.toLowerCase();o[e]=a[c]}for(const c in e.attributes){const t=mr[c]||c.toLowerCase();if(void 0!==a[c]){const n=r.accessors[e.attributes[c]],s=hr[n.componentType];A[t]=s.name,i[t]=!0===n.normalized}}return t.getDependency("bufferView",s).then((function(e){return new Promise((function(t,r){n.decodeDracoFile(e,(function(e){for(const t in e.attributes){const r=e.attributes[t],n=i[t];void 0!==n&&(r.normalized=n)}t(e)}),o,A,St,r)}))}))}}class Ar{constructor(){this.name=Lt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&t.texCoord!==e.channel||void 0!==t.offset||void 0!==t.rotation||void 0!==t.scale?(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0,e):e}}class cr{constructor(){this.name=Lt.KHR_MESH_QUANTIZATION}}class lr extends Ie{constructor(e,t,r,n){super(e,t,r,n)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,s=e*n*3+n;for(let a=0;a!==n;a++)t[a]=r[s+a];return t}interpolate_(e,t,r,n){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,i=2*o,A=3*o,c=n-t,l=(r-t)/c,u=l*l,B=u*l,d=e*A,h=d-A,f=-2*B+3*u,C=B-u,p=1-f,m=C-u+l;for(let g=0;g!==o;g++){const e=a[h+g+o],t=a[h+g+i]*c,r=a[d+g+o],n=a[d+g]*c;s[g]=p*e+m*t+f*r+C*n}return s}}const ur=new ie;class Br extends lr{interpolate_(e,t,r,n){const s=super.interpolate_(e,t,r,n);return ur.fromArray(s).normalize().toArray(s),s}}const dr={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},hr={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},fr={9728:Ae,9729:P,9984:ce,9985:le,9986:ue,9987:_},Cr={33071:Be,33648:de,10497:K},pr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},mr=(gr=i({POSITION:"position",NORMAL:"normal",TANGENT:"tangent"},st>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"}),t(gr,r({COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"})));var gr;const Er={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Mr={CUBICSPLINE:void 0,LINEAR:oe,STEP:he},Fr="OPAQUE",Ir="MASK",vr="BLEND";function Rr(e,t,r){for(const n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function Gr(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function Dr(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){const r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,n=r.length;t<n;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function yr(e){let t;const r=e.extensions&&e.extensions[Lt.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+wr(r.attributes):e.indices+":"+wr(e.attributes)+":"+e.mode,void 0!==e.targets)for(let n=0,s=e.targets.length;n<s;n++)t+=":"+wr(e.targets[n]);return t}function wr(e){let t="";const r=Object.keys(e).sort();for(let n=0,s=r.length;n<s;n++)t+=r[n]+":"+e[r[n]]+";";return t}function br(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Hr=new b;class Tr{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Ut,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,n=!1,s=-1;"undefined"!=typeof navigator&&void 0!==navigator.userAgent&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),n=navigator.userAgent.indexOf("Firefox")>-1,s=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||n&&s<98?this.textureLoader=new S(this.options.manager):this.textureLoader=new O(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new F(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,n=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){const a={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};return Rr(s,a,n),Gr(a,n),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(a)}))).then((function(){for(const e of a.scenes)e.updateMatrixWorld();e(a)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let n=0,s=t.length;n<s;n++){const r=t[n].joints;for(let t=0,n=r.length;t<n;t++)e[r[t]].isBone=!0}for(let n=0,s=e.length;n<s;n++){const t=e[n];void 0!==t.mesh&&(this._addNodeRef(this.meshCache,t.mesh),void 0!==t.skin&&(r[t.mesh].isSkinnedMesh=!0)),void 0!==t.camera&&this._addNodeRef(this.cameraCache,t.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const n=r.clone(),s=(e,t)=>{const r=this.associations.get(e);null!=r&&this.associations.set(t,r);for(const[n,a]of e.children.entries())s(a,t.children[n])};return s(r,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const n=e(t[r]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let n=0;n<t.length;n++){const s=e(t[n]);s&&r.push(s)}return r}getDependency(e,t){const r=e+":"+t;let n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne((function(e){return e.loadNode&&e.loadNode(t)}));break;case"mesh":n=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":n=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne((function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})),!n)throw new Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Lt.KHR_BINARY_GLTF].body);const n=this.options;return new Promise((function(e,s){r.load(M.resolveURL(t.uri,n.path),e,void 0,(function(){s(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))}loadAccessor(e){const t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse){const e=pr[n.type],t=hr[n.componentType],r=!0===n.normalized,s=new t(n.count*e);return Promise.resolve(new U(s,e,r))}const s=[];return void 0!==n.bufferView?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),void 0!==n.sparse&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then((function(e){const s=e[0],a=pr[n.type],o=hr[n.componentType],i=o.BYTES_PER_ELEMENT,A=i*a,c=n.byteOffset||0,l=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,u=!0===n.normalized;let B,d;if(l&&l!==A){const e=Math.floor(c/l),r="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count;let A=t.cache.get(r);A||(B=new o(s,e*l,n.count*l/i),A=new L(B,l/i),t.cache.add(r,A)),d=new Ce(A,a,c%l/i,u)}else B=null===s?new o(n.count*a):new o(s,c,n.count*a),d=new U(B,a,u);if(void 0!==n.sparse){const t=pr.SCALAR,r=hr[n.sparse.indices.componentType],i=n.sparse.indices.byteOffset||0,A=n.sparse.values.byteOffset||0,c=new r(e[1],i,n.sparse.count*t),l=new o(e[2],A,n.sparse.count*a);null!==s&&(d=new U(d.array.slice(),d.itemSize,d.normalized));for(let e=0,n=c.length;e<n;e++){const t=c[e];if(d.setX(t,l[e*a]),a>=2&&d.setY(t,l[e*a+1]),a>=3&&d.setZ(t,l[e*a+2]),a>=4&&d.setW(t,l[e*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d}))}loadTexture(e){const t=this.json,r=this.options,n=t.textures[e].source,s=t.images[n];let a=this.textureLoader;if(s.uri){const e=r.manager.getHandler(s.uri);null!==e&&(a=e)}return this.loadTextureImage(e,n,a)}loadTextureImage(e,t,r){const n=this,s=this.json,a=s.textures[e],o=s.images[t],i=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[i])return this.textureCache[i];const A=this.loadImageSource(t,r).then((function(t){t.flipY=!1,t.name=a.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);const r=(s.samplers||{})[a.sampler]||{};return t.magFilter=fr[r.magFilter]||P,t.minFilter=fr[r.minFilter]||_,t.wrapS=Cr[r.wrapS]||K,t.wrapT=Cr[r.wrapT]||K,n.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[i]=A,A}loadImageSource(e,t){const r=this,n=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const a=n.images[e],o=self.URL||self.webkitURL;let i=a.uri||"",A=!1;if(void 0!==a.bufferView)i=r.getDependency("bufferView",a.bufferView).then((function(e){A=!0;const t=new Blob([e],{type:a.mimeType});return i=o.createObjectURL(t),i}));else if(void 0===a.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(i).then((function(e){return new Promise((function(r,n){let a=r;!0===t.isImageBitmapLoader&&(a=function(e){const t=new pe(e);t.needsUpdate=!0,r(t)}),t.load(M.resolveURL(e,s.path),a,void 0,n)}))})).then((function(e){var t;return!0===A&&o.revokeObjectURL(i),Gr(e,a),e.userData.mimeType=a.mimeType||((t=a.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",i),e}));return this.sourceCache[e]=c,c}assignTexture(e,t,r,n){const s=this;return this.getDependency("texture",r.index).then((function(a){if(!a)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((a=a.clone()).channel=r.texCoord),s.extensions[Lt.KHR_TEXTURE_TRANSFORM]){const e=void 0!==r.extensions?r.extensions[Lt.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=s.associations.get(a);a=s.extensions[Lt.KHR_TEXTURE_TRANSFORM].extendTexture(a,e),s.associations.set(a,t)}}return void 0!==n&&("number"==typeof n&&(n=3001===n?Jt:St),"colorSpace"in a?a.colorSpace=n:a.encoding=n===Jt?3001:3e3),e[t]=a,a}))}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const n=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+r.uuid;let t=this.cache.get(e);t||(t=new N,k.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){const e="LineBasicMaterial:"+r.uuid;let t=this.cache.get(e);t||(t=new Q,k.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(n||s||a){let e="ClonedMaterial:"+r.uuid+":";n&&(e+="derivative-tangents:"),s&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),s&&(t.vertexColors=!0),a&&(t.flatShading=!0),n&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return X}loadMaterial(e){const t=this,r=this.json,n=this.extensions,s=r.materials[e];let a;const o={},i=[];if((s.extensions||{})[Lt.KHR_MATERIALS_UNLIT]){const e=n[Lt.KHR_MATERIALS_UNLIT];a=e.getMaterialType(),i.push(e.extendParams(o,s,t))}else{const r=s.pbrMetallicRoughness||{};if(o.color=new I(1,1,1),o.opacity=1,Array.isArray(r.baseColorFactor)){const e=r.baseColorFactor;o.color.setRGB(e[0],e[1],e[2],St),o.opacity=e[3]}void 0!==r.baseColorTexture&&i.push(t.assignTexture(o,"map",r.baseColorTexture,Jt)),o.metalness=void 0!==r.metallicFactor?r.metallicFactor:1,o.roughness=void 0!==r.roughnessFactor?r.roughnessFactor:1,void 0!==r.metallicRoughnessTexture&&(i.push(t.assignTexture(o,"metalnessMap",r.metallicRoughnessTexture)),i.push(t.assignTexture(o,"roughnessMap",r.metallicRoughnessTexture))),a=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),i.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===s.doubleSided&&(o.side=g);const A=s.alphaMode||Fr;if(A===vr?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,A===Ir&&(o.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&a!==D&&(i.push(t.assignTexture(o,"normalMap",s.normalTexture)),o.normalScale=new w(1,1),void 0!==s.normalTexture.scale)){const e=s.normalTexture.scale;o.normalScale.set(e,e)}if(void 0!==s.occlusionTexture&&a!==D&&(i.push(t.assignTexture(o,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(o.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&a!==D){const e=s.emissiveFactor;o.emissive=(new I).setRGB(e[0],e[1],e[2],St)}return void 0!==s.emissiveTexture&&a!==D&&i.push(t.assignTexture(o,"emissiveMap",s.emissiveTexture,Jt)),Promise.all(i).then((function(){const r=new a(o);return s.name&&(r.name=s.name),Gr(r,s),t.associations.set(r,{materials:e}),s.extensions&&Rr(n,r,s),r}))}createUniqueName(e){const t=j.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,n=this.primitiveCache;function s(e){return r[Lt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return xr(r,e,t)}))}const a=[];for(let o=0,i=e.length;o<i;o++){const r=e[o],i=yr(r),A=n[i];if(A)a.push(A.promise);else{let e;e=r.extensions&&r.extensions[Lt.KHR_DRACO_MESH_COMPRESSION]?s(r):xr(new Y,r,t),n[i]={primitive:r,promise:e},a.push(e)}}return Promise.all(a)}loadMesh(e){const t=this,r=this.json,n=this.extensions,s=r.meshes[e],a=s.primitives,o=[];for(let A=0,c=a.length;A<c;A++){const e=void 0===a[A].material?(void 0===(i=this.cache).DefaultMaterial&&(i.DefaultMaterial=new X({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:fe})),i.DefaultMaterial):this.getDependency("material",a[A].material);o.push(e)}var i;return o.push(t.loadGeometries(a)),Promise.all(o).then((function(r){const o=r.slice(0,r.length-1),i=r[r.length-1],A=[];for(let l=0,u=i.length;l<u;l++){const r=i[l],c=a[l];let u;const B=o[l];if(c.mode===dr.TRIANGLES||c.mode===dr.TRIANGLE_STRIP||c.mode===dr.TRIANGLE_FAN||void 0===c.mode)u=!0===s.isSkinnedMesh?new Z(r,B):new C(r,B),!0===u.isSkinnedMesh&&u.normalizeSkinWeights(),c.mode===dr.TRIANGLE_STRIP?u.geometry=at(u.geometry,f):c.mode===dr.TRIANGLE_FAN&&(u.geometry=at(u.geometry,h));else if(c.mode===dr.LINES)u=new W(r,B);else if(c.mode===dr.LINE_STRIP)u=new V(r,B);else if(c.mode===dr.LINE_LOOP)u=new q(r,B);else{if(c.mode!==dr.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);u=new z(r,B)}Object.keys(u.geometry.morphAttributes).length>0&&Dr(u,s),u.name=t.createUniqueName(s.name||"mesh_"+e),Gr(u,s),c.extensions&&Rr(n,u,c),t.assignFinalMaterial(u),A.push(u)}for(let n=0,s=A.length;n<s;n++)t.associations.set(A[n],{meshes:e,primitives:n});if(1===A.length)return s.extensions&&Rr(n,A[0],s),A[0];const c=new $;s.extensions&&Rr(n,c,s),t.associations.set(c,{meshes:e});for(let e=0,t=A.length;e<t;e++)c.add(A[e]);return c}))}loadCamera(e){let t;const r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new ee(te.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new re(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),Gr(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],r=[];for(let n=0,s=t.joints.length;n<s;n++)r.push(this._loadNodeShallow(t.joints[n]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then((function(e){const r=e.pop(),n=e,s=[],a=[];for(let o=0,i=n.length;o<i;o++){const e=n[o];if(e){s.push(e);const t=new b;null!==r&&t.fromArray(r.array,16*o),a.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}return new ne(s,a)}))}loadAnimation(e){const t=this.json,r=this,n=t.animations[e],s=n.name?n.name:"animation_"+e,a=[],o=[],i=[],A=[],c=[];for(let l=0,u=n.channels.length;l<u;l++){const e=n.channels[l],t=n.samplers[e.sampler],r=e.target,s=r.node,u=void 0!==n.parameters?n.parameters[t.input]:t.input,B=void 0!==n.parameters?n.parameters[t.output]:t.output;void 0!==r.node&&(a.push(this.getDependency("node",s)),o.push(this.getDependency("accessor",u)),i.push(this.getDependency("accessor",B)),A.push(t),c.push(r))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(i),Promise.all(A),Promise.all(c)]).then((function(e){const t=e[0],n=e[1],a=e[2],o=e[3],i=e[4],A=[];for(let s=0,c=t.length;s<c;s++){const e=t[s],c=n[s],l=a[s],u=o[s],B=i[s];if(void 0===e)continue;e.updateMatrix&&e.updateMatrix();const d=r._createAnimationTracks(e,c,l,u,B);if(d)for(let t=0;t<d.length;t++)A.push(d[t])}return new se(s,void 0,A)}))}createNodeMesh(e){const t=this.json,r=this,n=t.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then((function(e){const t=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]})),t}))}loadNode(e){const t=this,r=this.json.nodes[e],n=t._loadNodeShallow(e),s=[],a=r.children||[];for(let i=0,A=a.length;i<A;i++)s.push(t.getDependency("node",a[i]));const o=void 0===r.skin?Promise.resolve(null):t.getDependency("skin",r.skin);return Promise.all([n,Promise.all(s),o]).then((function(e){const t=e[0],r=e[1],n=e[2];null!==n&&t.traverse((function(e){e.isSkinnedMesh&&e.bind(n,Hr)}));for(let s=0,a=r.length;s<a;s++)t.add(r[s]);return t}))}_loadNodeShallow(e){const t=this.json,r=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];const s=t.nodes[e],a=s.name?n.createUniqueName(s.name):"",o=[],i=n._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return i&&o.push(i),void 0!==s.camera&&o.push(n.getDependency("camera",s.camera).then((function(e){return n._getNodeRef(n.cameraCache,s.camera,e)}))),n._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){o.push(e)})),this.nodeCache[e]=Promise.all(o).then((function(t){let o;if(o=!0===s.isBone?new ae:t.length>1?new $:1===t.length?t[0]:new J,o!==t[0])for(let e=0,r=t.length;e<r;e++)o.add(t[e]);if(s.name&&(o.userData.name=s.name,o.name=a),Gr(o,s),s.extensions&&Rr(r,o,s),void 0!==s.matrix){const e=new b;e.fromArray(s.matrix),o.applyMatrix4(e)}else void 0!==s.translation&&o.position.fromArray(s.translation),void 0!==s.rotation&&o.quaternion.fromArray(s.rotation),void 0!==s.scale&&o.scale.fromArray(s.scale);return n.associations.has(o)||n.associations.set(o,{}),n.associations.get(o).nodes=e,o})),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],n=this,s=new $;r.name&&(s.name=n.createUniqueName(r.name)),Gr(s,r),r.extensions&&Rr(t,s,r);const a=r.nodes||[],o=[];for(let i=0,A=a.length;i<A;i++)o.push(n.getDependency("node",a[i]));return Promise.all(o).then((function(e){for(let t=0,r=e.length;t<r;t++)s.add(e[t]);return n.associations=(e=>{const t=new Map;for(const[r,s]of n.associations)(r instanceof k||r instanceof pe)&&t.set(r,s);return e.traverse((e=>{const r=n.associations.get(e);null!=r&&t.set(e,r)})),t})(s),s}))}_createAnimationTracks(e,t,r,n,s){const a=[],o=e.name?e.name:e.uuid,i=[];let A;switch(Er[s.path]===Er.weights?e.traverse((function(e){e.morphTargetInfluences&&i.push(e.name?e.name:e.uuid)})):i.push(o),Er[s.path]){case Er.weights:A=ge;break;case Er.rotation:A=Ee;break;case Er.position:case Er.scale:A=me;break;default:if(1===r.itemSize)A=ge;else A=me}const c=void 0!==n.interpolation?Mr[n.interpolation]:oe,l=this._getArrayFromAccessor(r);for(let u=0,B=i.length;u<B;u++){const e=new A(i[u]+"."+Er[s.path],t.array,l,c);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(e),a.push(e)}return a}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const e=br(t.constructor),r=new Float32Array(t.length);for(let n=0,s=t.length;n<s;n++)r[n]=t[n]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof Ee?Br:lr)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function xr(e,t,r){const n=t.attributes,s=[];function a(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(const o in n){const t=mr[o]||o.toLowerCase();t in e.attributes||s.push(a(n[o],t))}if(void 0!==t.indices&&!e.index){const n=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));s.push(n)}return Gr(e,t),function(e,t,r){const n=t.attributes,s=new Me;if(void 0===n.POSITION)return;{const e=r.json.accessors[n.POSITION],t=e.min,a=e.max;if(void 0===t||void 0===a)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(s.set(new H(t[0],t[1],t[2]),new H(a[0],a[1],a[2])),e.normalized){const t=br(hr[e.componentType]);s.min.multiplyScalar(t),s.max.multiplyScalar(t)}}const a=t.targets;if(void 0!==a){const e=new H,t=new H;for(let n=0,s=a.length;n<s;n++){const s=a[n];if(void 0!==s.POSITION){const n=r.json.accessors[s.POSITION],a=n.min,o=n.max;if(void 0!==a&&void 0!==o){if(t.setX(Math.max(Math.abs(a[0]),Math.abs(o[0]))),t.setY(Math.max(Math.abs(a[1]),Math.abs(o[1]))),t.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2]))),n.normalized){const e=br(hr[n.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(e)}e.boundingBox=s;const o=new Fe;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=o}(e,t,r),Promise.all(s).then((function(){return void 0!==t.targets?function(e,t,r){let n=!1,s=!1,a=!1;for(let c=0,l=t.length;c<l;c++){const e=t[c];if(void 0!==e.POSITION&&(n=!0),void 0!==e.NORMAL&&(s=!0),void 0!==e.COLOR_0&&(a=!0),n&&s&&a)break}if(!n&&!s&&!a)return Promise.resolve(e);const o=[],i=[],A=[];for(let c=0,l=t.length;c<l;c++){const l=t[c];if(n){const t=void 0!==l.POSITION?r.getDependency("accessor",l.POSITION):e.attributes.position;o.push(t)}if(s){const t=void 0!==l.NORMAL?r.getDependency("accessor",l.NORMAL):e.attributes.normal;i.push(t)}if(a){const t=void 0!==l.COLOR_0?r.getDependency("accessor",l.COLOR_0):e.attributes.color;A.push(t)}}return Promise.all([Promise.all(o),Promise.all(i),Promise.all(A)]).then((function(t){const r=t[0],o=t[1],i=t[2];return n&&(e.morphAttributes.position=r),s&&(e.morphAttributes.normal=o),a&&(e.morphAttributes.color=i),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}class Jr extends ve{constructor(e){super(e),this.type=Re}parse(e){const t=function(e,t){switch(e){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(t||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(t||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(t||""));default:throw new Error("THREE.RGBELoader: Memory Error: "+(t||""))}},r=function(e,t,r){t=t||1024;let n=e.pos,s=-1,a=0,o="",i=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));for(;0>(s=i.indexOf("\n"))&&a<t&&n<e.byteLength;)o+=i,a+=i.length,n+=128,i+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(n,n+128)));return-1<s&&(!1!==r&&(e.pos+=a+s+1),o+i.slice(0,s))},n=function(e,t,r,n){const s=e[t+3],a=Math.pow(2,s-128)/255;r[n+0]=e[t+0]*a,r[n+1]=e[t+1]*a,r[n+2]=e[t+2]*a,r[n+3]=1},s=function(e,t,r,n){const s=e[t+3],a=Math.pow(2,s-128)/255;r[n+0]=De.toHalfFloat(Math.min(e[t+0]*a,65504)),r[n+1]=De.toHalfFloat(Math.min(e[t+1]*a,65504)),r[n+2]=De.toHalfFloat(Math.min(e[t+2]*a,65504)),r[n+3]=De.toHalfFloat(1)},a=new Uint8Array(e);a.pos=0;const o=function(e){const n=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,a=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,i={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let A,c;for((e.pos>=e.byteLength||!(A=r(e)))&&t(1,"no header found"),(c=A.match(/^#\?(\S+)/))||t(3,"bad initial token"),i.valid|=1,i.programtype=c[1],i.string+=A+"\n";A=r(e),!1!==A;)if(i.string+=A+"\n","#"!==A.charAt(0)){if((c=A.match(n))&&(i.gamma=parseFloat(c[1])),(c=A.match(s))&&(i.exposure=parseFloat(c[1])),(c=A.match(a))&&(i.valid|=2,i.format=c[1]),(c=A.match(o))&&(i.valid|=4,i.height=parseInt(c[1],10),i.width=parseInt(c[2],10)),2&i.valid&&4&i.valid)break}else i.comments+=A+"\n";return 2&i.valid||t(3,"missing format specifier"),4&i.valid||t(3,"missing image size specifier"),i}(a),i=o.width,A=o.height,c=function(e,r,n){const s=r;if(s<8||s>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);s!==(e[2]<<8|e[3])&&t(3,"wrong scanline width");const a=new Uint8Array(4*r*n);a.length||t(4,"unable to allocate buffer space");let o=0,i=0;const A=4*s,c=new Uint8Array(4),l=new Uint8Array(A);let u=n;for(;u>0&&i<e.byteLength;){i+4>e.byteLength&&t(1),c[0]=e[i++],c[1]=e[i++],c[2]=e[i++],c[3]=e[i++],2==c[0]&&2==c[1]&&(c[2]<<8|c[3])==s||t(3,"bad rgbe scanline format");let r,n=0;for(;n<A&&i<e.byteLength;){r=e[i++];const s=r>128;if(s&&(r-=128),(0===r||n+r>A)&&t(3,"bad scanline data"),s){const t=e[i++];for(let e=0;e<r;e++)l[n++]=t}else l.set(e.subarray(i,i+r),n),n+=r,i+=r}const B=s;for(let e=0;e<B;e++){let t=0;a[o]=l[e+t],t+=s,a[o+1]=l[e+t],t+=s,a[o+2]=l[e+t],t+=s,a[o+3]=l[e+t],o+=4}u--}return a}(a.subarray(a.pos),i,A);let l,u,B;switch(this.type){case Ge:B=c.length/4;const e=new Float32Array(4*B);for(let r=0;r<B;r++)n(c,4*r,e,4*r);l=e,u=Ge;break;case Re:B=c.length/4;const t=new Uint16Array(4*B);for(let r=0;r<B;r++)s(c,4*r,t,4*r);l=t,u=Re;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:i,height:A,data:l,header:o.string,gamma:o.gamma,exposure:o.exposure,type:u}}setDataType(e){return this.type=e,this}load(e,t,r,n){return super.load(e,(function(e,r){switch(e.type){case Ge:case Re:"colorSpace"in e?e.colorSpace="srgb-linear":e.encoding=3e3,e.minFilter=P,e.magFilter=P,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,r)}),r,n)}}const Sr=st>=152;class Or extends ve{constructor(e){super(e),this.type=Re}parse(e){const t=65536,r=14,n=65537,s=16384,a=Math.pow(2.7182818,2.2);const o={l:0,c:0,lc:0};function i(e,t,r,n,s){for(;r<e;)t=t<<8|K(n,s),r+=8;r-=e,o.l=t>>r&(1<<e)-1,o.c=t,o.lc=r}const A=new Array(59);function c(e,t,r,s,a,c,l){for(var u=r,B=0,d=0;a<=c;a++){if(u.value-r.value>s)return!1;i(6,B,d,e,u);var h=o.l;if(B=o.c,d=o.lc,l[a]=h,63==h){if(u.value-r.value>s)throw"Something wrong with hufUnpackEncTable";i(8,B,d,e,u);var f=o.l+6;if(B=o.c,d=o.lc,a+f>c+1)throw"Something wrong with hufUnpackEncTable";for(;f--;)l[a++]=0;a--}else if(h>=59){if(a+(f=h-59+2)>c+1)throw"Something wrong with hufUnpackEncTable";for(;f--;)l[a++]=0;a--}}!function(e){for(var t=0;t<=58;++t)A[t]=0;for(t=0;t<n;++t)A[e[t]]+=1;var r=0;for(t=58;t>0;--t){var s=r+A[t]>>1;A[t]=r,r=s}for(t=0;t<n;++t){var a=e[t];a>0&&(e[t]=a|A[a]++<<6)}}(l)}function l(e){return 63&e}function u(e){return e>>6}const B={c:0,lc:0};function d(e,t,r,n){e=e<<8|K(r,n),t+=8,B.c=e,B.lc=t}const h={c:0,lc:0};function f(e,t,r,n,s,a,o,i,A,c){if(e==t){n<8&&(d(r,n,s,o),r=B.c,n=B.lc);var l=r>>(n-=8);l=new Uint8Array([l])[0];if(A.value+l>c)return!1;for(var u=i[A.value-1];l-- >0;)i[A.value++]=u}else{if(!(A.value<c))return!1;i[A.value++]=e}h.c=r,h.lc=n}function C(e){return 65535&e}function p(e){var t=C(e);return t>32767?t-65536:t}const m={a:0,b:0};function g(e,t){var r=p(e),n=p(t),s=r+(1&n)+(n>>1),a=s,o=s-n;m.a=a,m.b=o}function E(e,t){var r=C(e),n=C(t),s=r-(n>>1)&65535,a=n+s-32768&65535;m.a=a,m.b=s}function M(e,t,r,n,s,a,o){for(var i,A=o<16384,c=r>s?s:r,l=1;l<=c;)l<<=1;for(i=l>>=1,l>>=1;l>=1;){for(var u,B,d,h,f=0,C=f+a*(s-i),p=a*l,M=a*i,F=n*l,I=n*i;f<=C;f+=M){for(var v=f,R=f+n*(r-i);v<=R;v+=I){var G=v+F,D=(y=v+p)+F;A?(g(e[v+t],e[y+t]),u=m.a,d=m.b,g(e[G+t],e[D+t]),B=m.a,h=m.b,g(u,B),e[v+t]=m.a,e[G+t]=m.b,g(d,h),e[y+t]=m.a,e[D+t]=m.b):(E(e[v+t],e[y+t]),u=m.a,d=m.b,E(e[G+t],e[D+t]),B=m.a,h=m.b,E(u,B),e[v+t]=m.a,e[G+t]=m.b,E(d,h),e[y+t]=m.a,e[D+t]=m.b)}if(r&l){var y=v+p;A?g(e[v+t],e[y+t]):E(e[v+t],e[y+t]),u=m.a,e[y+t]=m.b,e[v+t]=u}}if(s&l)for(v=f,R=f+n*(r-i);v<=R;v+=I){G=v+F;A?g(e[v+t],e[G+t]):E(e[v+t],e[G+t]),u=m.a,e[G+t]=m.b,e[v+t]=u}i=l,l>>=1}return f}function F(e,t,a,o,i,A){var C=a.value,p=_(t,a),m=_(t,a);a.value+=4;var g=_(t,a);if(a.value+=4,p<0||p>=n||m<0||m>=n)throw"Something wrong with HUF_ENCSIZE";var E=new Array(n),M=new Array(s);if(function(e){for(var t=0;t<s;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(M),c(e,0,a,o-(a.value-C),p,m,E),g>8*(o-(a.value-C)))throw"Something wrong with hufUncompress";!function(e,t,n,s){for(;t<=n;t++){var a=u(e[t]),o=l(e[t]);if(a>>o)throw"Invalid table entry";if(o>r){if((B=s[a>>o-r]).len)throw"Invalid table entry";if(B.lit++,B.p){var i=B.p;B.p=new Array(B.lit);for(var A=0;A<B.lit-1;++A)B.p[A]=i[A]}else B.p=new Array(1);B.p[B.lit-1]=t}else if(o){var c=0;for(A=1<<r-o;A>0;A--){var B;if((B=s[(a<<r-o)+c]).len||B.p)throw"Invalid table entry";B.len=o,B.lit=t,c++}}}}(E,p,m,M),function(e,t,n,s,a,o,i,A,c,C){for(var p=0,m=0,g=A,E=Math.trunc(a.value+(o+7)/8);a.value<E;)for(d(p,m,n,a),p=B.c,m=B.lc;m>=r;)if((v=t[p>>m-r&16383]).len)m-=v.len,f(v.lit,i,p,m,n,0,a,c,C,g),p=h.c,m=h.lc;else{if(!v.p)throw"hufDecode issues";var M;for(M=0;M<v.lit;M++){for(var F=l(e[v.p[M]]);m<F&&a.value<E;)d(p,m,n,a),p=B.c,m=B.lc;if(m>=F&&u(e[v.p[M]])==(p>>m-F&(1<<F)-1)){m-=F,f(v.p[M],i,p,m,n,0,a,c,C,g),p=h.c,m=h.lc;break}}if(M==v.lit)throw"hufDecode issues"}var I=8-o&7;for(p>>=I,m-=I;m>0;){var v;if(!(v=t[p<<r-m&16383]).len)throw"hufDecode issues";m-=v.len,f(v.lit,i,p,m,n,0,a,c,C,g),p=h.c,m=h.lc}}(E,M,e,0,a,g,m,A,i,{value:0})}function I(e){for(var t=1;t<e.length;t++){var r=e[t-1]+e[t]-128;e[t]=r}}function v(e,t){for(var r=0,n=Math.floor((e.length+1)/2),s=0,a=e.length-1;!(s>a||(t[s++]=e[r++],s>a));)t[s++]=e[n++]}function R(e){for(var t=e.byteLength,r=new Array,n=0,s=new DataView(e);t>0;){var a=s.getInt8(n++);if(a<0){t-=(i=-a)+1;for(var o=0;o<i;o++)r.push(s.getUint8(n++))}else{var i=a;t-=2;var A=s.getUint8(n++);for(o=0;o<i+1;o++)r.push(A)}}return r}function G(e,t,r){for(var n,s=1;s<64;)65280==(n=t[e.value])?s=64:n>>8==255?s+=255&n:(r[s]=n,s++),e.value++}function D(e,t){t[0]=j(e[0]),t[1]=j(e[1]),t[2]=j(e[5]),t[3]=j(e[6]),t[4]=j(e[14]),t[5]=j(e[15]),t[6]=j(e[27]),t[7]=j(e[28]),t[8]=j(e[2]),t[9]=j(e[4]),t[10]=j(e[7]),t[11]=j(e[13]),t[12]=j(e[16]),t[13]=j(e[26]),t[14]=j(e[29]),t[15]=j(e[42]),t[16]=j(e[3]),t[17]=j(e[8]),t[18]=j(e[12]),t[19]=j(e[17]),t[20]=j(e[25]),t[21]=j(e[30]),t[22]=j(e[41]),t[23]=j(e[43]),t[24]=j(e[9]),t[25]=j(e[11]),t[26]=j(e[18]),t[27]=j(e[24]),t[28]=j(e[31]),t[29]=j(e[40]),t[30]=j(e[44]),t[31]=j(e[53]),t[32]=j(e[10]),t[33]=j(e[19]),t[34]=j(e[23]),t[35]=j(e[32]),t[36]=j(e[39]),t[37]=j(e[45]),t[38]=j(e[52]),t[39]=j(e[54]),t[40]=j(e[20]),t[41]=j(e[22]),t[42]=j(e[33]),t[43]=j(e[38]),t[44]=j(e[46]),t[45]=j(e[51]),t[46]=j(e[55]),t[47]=j(e[60]),t[48]=j(e[21]),t[49]=j(e[34]),t[50]=j(e[37]),t[51]=j(e[47]),t[52]=j(e[50]),t[53]=j(e[56]),t[54]=j(e[59]),t[55]=j(e[61]),t[56]=j(e[35]),t[57]=j(e[36]),t[58]=j(e[48]),t[59]=j(e[49]),t[60]=j(e[57]),t[61]=j(e[58]),t[62]=j(e[62]),t[63]=j(e[63])}function y(e){const t=.5*Math.cos(.7853975),r=.5*Math.cos(3.14159/16),n=.5*Math.cos(3.14159/8),s=.5*Math.cos(3*3.14159/16),a=.5*Math.cos(.981746875),o=.5*Math.cos(3*3.14159/8),i=.5*Math.cos(1.374445625);for(var A=new Array(4),c=new Array(4),l=new Array(4),u=new Array(4),B=0;B<8;++B){var d=8*B;A[0]=n*e[d+2],A[1]=o*e[d+2],A[2]=n*e[d+6],A[3]=o*e[d+6],c[0]=r*e[d+1]+s*e[d+3]+a*e[d+5]+i*e[d+7],c[1]=s*e[d+1]-i*e[d+3]-r*e[d+5]-a*e[d+7],c[2]=a*e[d+1]-r*e[d+3]+i*e[d+5]+s*e[d+7],c[3]=i*e[d+1]-a*e[d+3]+s*e[d+5]-r*e[d+7],l[0]=t*(e[d+0]+e[d+4]),l[3]=t*(e[d+0]-e[d+4]),l[1]=A[0]+A[3],l[2]=A[1]-A[2],u[0]=l[0]+l[1],u[1]=l[3]+l[2],u[2]=l[3]-l[2],u[3]=l[0]-l[1],e[d+0]=u[0]+c[0],e[d+1]=u[1]+c[1],e[d+2]=u[2]+c[2],e[d+3]=u[3]+c[3],e[d+4]=u[3]-c[3],e[d+5]=u[2]-c[2],e[d+6]=u[1]-c[1],e[d+7]=u[0]-c[0]}for(var h=0;h<8;++h)A[0]=n*e[16+h],A[1]=o*e[16+h],A[2]=n*e[48+h],A[3]=o*e[48+h],c[0]=r*e[8+h]+s*e[24+h]+a*e[40+h]+i*e[56+h],c[1]=s*e[8+h]-i*e[24+h]-r*e[40+h]-a*e[56+h],c[2]=a*e[8+h]-r*e[24+h]+i*e[40+h]+s*e[56+h],c[3]=i*e[8+h]-a*e[24+h]+s*e[40+h]-r*e[56+h],l[0]=t*(e[h]+e[32+h]),l[3]=t*(e[h]-e[32+h]),l[1]=A[0]+A[3],l[2]=A[1]-A[2],u[0]=l[0]+l[1],u[1]=l[3]+l[2],u[2]=l[3]-l[2],u[3]=l[0]-l[1],e[0+h]=u[0]+c[0],e[8+h]=u[1]+c[1],e[16+h]=u[2]+c[2],e[24+h]=u[3]+c[3],e[32+h]=u[3]-c[3],e[40+h]=u[2]-c[2],e[48+h]=u[1]-c[1],e[56+h]=u[0]-c[0]}function w(e){for(var t=0;t<64;++t){var r=e[0][t],n=e[1][t],s=e[2][t];e[0][t]=r+1.5747*s,e[1][t]=r-.1873*n-.4682*s,e[2][t]=r+1.8556*n}}function b(e,t,r){for(var n=0;n<64;++n)t[r+n]=De.toHalfFloat(H(e[n]))}function H(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(a,Math.abs(e)-1)}function T(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function x(e){var t=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),r=new Uint8Array(R(t)),n=new Uint8Array(r.length);return I(r),v(r,n),new DataView(n.buffer)}function J(e){var t=bt(e.array.slice(e.offset.value,e.offset.value+e.size)),r=new Uint8Array(t.length);return I(t),v(t,r),new DataView(r.buffer)}function S(e){for(var r=e.viewer,n={value:e.offset.value},s=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),a=new Uint8Array(8192),o=0,i=new Array(e.channels),A=0;A<e.channels;A++)i[A]={},i[A].start=o,i[A].end=i[A].start,i[A].nx=e.width,i[A].ny=e.lines,i[A].size=e.type,o+=i[A].nx*i[A].ny*i[A].size;var c=Y(r,n),l=Y(r,n);if(l>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(c<=l)for(A=0;A<l-c+1;A++)a[A+c]=N(r,n);var u=new Uint16Array(t),B=function(e,r){for(var n=0,s=0;s<t;++s)(0==s||e[s>>3]&1<<(7&s))&&(r[n++]=s);for(var a=n-1;n<t;)r[n++]=0;return a}(a,u),d=_(r,n);F(e.array,r,n,d,s,o);for(A=0;A<e.channels;++A)for(var h=i[A],f=0;f<i[A].size;++f)M(s,h.start+f,h.nx,h.size,h.ny,h.nx*h.size,B);!function(e,t,r){for(var n=0;n<r;++n)t[n]=e[t[n]]}(u,s,o);for(var C=0,p=new Uint8Array(s.buffer.byteLength),m=0;m<e.lines;m++)for(var g=0;g<e.channels;g++){var E=(h=i[g]).nx*h.size,I=new Uint8Array(s.buffer,2*h.end,2*E);p.set(I,C),C+=2*E,h.end+=E}return new DataView(p.buffer)}function O(e){var t=bt(e.array.slice(e.offset.value,e.offset.value+e.size));const r=e.lines*e.channels*e.width,n=1==e.type?new Uint16Array(r):new Uint32Array(r);let s=0,a=0;const o=new Array(4);for(let i=0;i<e.lines;i++)for(let r=0;r<e.channels;r++){let r=0;switch(e.type){case 1:o[0]=s,o[1]=o[0]+e.width,s=o[1]+e.width;for(let s=0;s<e.width;++s){r+=t[o[0]++]<<8|t[o[1]++],n[a]=r,a++}break;case 2:o[0]=s,o[1]=o[0]+e.width,o[2]=o[1]+e.width,s=o[2]+e.width;for(let s=0;s<e.width;++s){r+=t[o[0]++]<<24|t[o[1]++]<<16|t[o[2]++]<<8,n[a]=r,a++}}}return new DataView(n.buffer)}function U(e){var t=e.viewer,r={value:e.offset.value},n=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),s={version:k(t,r),unknownUncompressedSize:k(t,r),unknownCompressedSize:k(t,r),acCompressedSize:k(t,r),dcCompressedSize:k(t,r),rleCompressedSize:k(t,r),rleUncompressedSize:k(t,r),rleRawSize:k(t,r),totalAcUncompressedCount:k(t,r),totalDcUncompressedCount:k(t,r),acCompression:k(t,r)};if(s.version<2)throw"EXRLoader.parse: "+$.compression+" version "+s.version+" is unsupported";for(var a=new Array,o=Y(t,r)-2;o>0;){var i=L(t.buffer,r),A=N(t,r),c=A>>2&3,l=new Int8Array([(A>>4)-1])[0],u=N(t,r);a.push({name:i,index:l,type:u,compression:c}),o-=i.length+3}for(var B=$.channels,d=new Array(e.channels),h=0;h<e.channels;++h){var f=d[h]={},C=B[h];f.name=C.name,f.compression=0,f.decoded=!1,f.type=C.pixelType,f.pLinear=C.pLinear,f.width=e.width,f.height=e.lines}for(var p={idx:new Array(3)},m=0;m<e.channels;++m)for(f=d[m],h=0;h<a.length;++h){var g=a[h];f.name==g.name&&(f.compression=g.compression,g.index>=0&&(p.idx[g.index]=m),f.offset=m)}if(s.acCompressedSize>0)switch(s.acCompression){case 0:var E=new Uint16Array(s.totalAcUncompressedCount);F(e.array,t,r,s.acCompressedSize,E,s.totalAcUncompressedCount);break;case 1:var M=bt(e.array.slice(r.value,r.value+s.totalAcUncompressedCount));E=new Uint16Array(M.buffer);r.value+=s.totalAcUncompressedCount}if(s.dcCompressedSize>0){var I={array:e.array,offset:r,size:s.dcCompressedSize},v=new Uint16Array(J(I).buffer);r.value+=s.dcCompressedSize}if(s.rleRawSize>0){var H=R((M=bt(e.array.slice(r.value,r.value+s.rleCompressedSize))).buffer);r.value+=s.rleCompressedSize}var T=0,x=new Array(d.length);for(h=0;h<x.length;++h)x[h]=new Array;for(var S=0;S<e.lines;++S)for(var O=0;O<d.length;++O)x[O].push(T),T+=d[O].width*e.type*2;!function(e,t,r,n,s,a){var o=new DataView(a.buffer),i=r[e.idx[0]].width,A=r[e.idx[0]].height,c=Math.floor(i/8),l=Math.ceil(i/8),u=Math.ceil(A/8),B=i-8*(l-1),d=A-8*(u-1),h={value:0},f=new Array(3),C=new Array(3),p=new Array(3),m=new Array(3),g=new Array(3);for(let G=0;G<3;++G)g[G]=t[e.idx[G]],f[G]=G<1?0:f[G-1]+l*u,C[G]=new Float32Array(64),p[G]=new Uint16Array(64),m[G]=new Uint16Array(64*l);for(let T=0;T<u;++T){var E=8;T==u-1&&(E=d);var M=8;for(let e=0;e<l;++e){e==l-1&&(M=B);for(let e=0;e<3;++e)p[e].fill(0),p[e][0]=s[f[e]++],G(h,n,p[e]),D(p[e],C[e]),y(C[e]);w(C);for(let t=0;t<3;++t)b(C[t],m[t],64*e)}let t=0;for(let n=0;n<3;++n){const s=r[e.idx[n]].type;for(let e=8*T;e<8*T+E;++e){t=g[n][e];for(let r=0;r<c;++r){const a=64*r+8*(7&e);o.setUint16(t+0*s,m[n][a+0],!0),o.setUint16(t+2*s,m[n][a+1],!0),o.setUint16(t+4*s,m[n][a+2],!0),o.setUint16(t+6*s,m[n][a+3],!0),o.setUint16(t+8*s,m[n][a+4],!0),o.setUint16(t+10*s,m[n][a+5],!0),o.setUint16(t+12*s,m[n][a+6],!0),o.setUint16(t+14*s,m[n][a+7],!0),t+=16*s}}if(c!=l)for(let e=8*T;e<8*T+E;++e){const t=g[n][e]+8*c*2*s,r=64*c+8*(7&e);for(let e=0;e<M;++e)o.setUint16(t+2*e*s,m[n][r+e],!0)}}}for(var F=new Uint16Array(i),I=(o=new DataView(a.buffer),0);I<3;++I){r[e.idx[I]].decoded=!0;var v=r[e.idx[I]].type;if(2==r[I].type)for(var R=0;R<A;++R){const e=g[I][R];for(var H=0;H<i;++H)F[H]=o.getUint16(e+2*H*v,!0);for(H=0;H<i;++H)o.setFloat32(e+2*H*v,j(F[H]),!0)}}}(p,x,d,E,v,n);for(h=0;h<d.length;++h){if(!(f=d[h]).decoded){if(2!==f.compression)throw"EXRLoader.parse: unsupported channel compression";var U=0,P=0;for(S=0;S<e.lines;++S){for(var _=x[h][U],K=0;K<f.width;++K){for(var Q=0;Q<2*f.type;++Q)n[_++]=H[P+Q*f.width*f.height];P++}U++}}}return new DataView(n.buffer)}function L(e,t){for(var r=new Uint8Array(e),n=0;0!=r[t.value+n];)n+=1;var s=(new TextDecoder).decode(r.slice(t.value,t.value+n));return t.value=t.value+n+1,s}function P(e,t){var r=e.getInt32(t.value,!0);return t.value=t.value+4,r}function _(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+4,r}function K(e,t){var r=e[t.value];return t.value=t.value+1,r}function N(e,t){var r=e.getUint8(t.value);return t.value=t.value+1,r}const k=function(e,t){let r;return r="getBigInt64"in DataView.prototype?Number(e.getBigInt64(t.value,!0)):e.getUint32(t.value+4,!0)+Number(e.getUint32(t.value,!0)<<32),t.value+=8,r};function Q(e,t){var r=e.getFloat32(t.value,!0);return t.value+=4,r}function X(e,t){return De.toHalfFloat(Q(e,t))}function j(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function Y(e,t){var r=e.getUint16(t.value,!0);return t.value+=2,r}function Z(e,t){return j(Y(e,t))}function W(e,t,r,n,s){return"string"===n||"stringvector"===n||"iccProfile"===n?function(e,t,r){var n=(new TextDecoder).decode(new Uint8Array(e).slice(t.value,t.value+r));return t.value=t.value+r,n}(t,r,s):"chlist"===n?function(e,t,r,n){for(var s=r.value,a=[];r.value<s+n-1;){var o=L(t,r),i=P(e,r),A=N(e,r);r.value+=3;var c=P(e,r),l=P(e,r);a.push({name:o,pixelType:i,pLinear:A,xSampling:c,ySampling:l})}return r.value+=1,a}(e,t,r,s):"chromaticities"===n?function(e,t){return{redX:Q(e,t),redY:Q(e,t),greenX:Q(e,t),greenY:Q(e,t),blueX:Q(e,t),blueY:Q(e,t),whiteX:Q(e,t),whiteY:Q(e,t)}}(e,r):"compression"===n?function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][N(e,t)]}(e,r):"box2i"===n?function(e,t){return{xMin:_(e,t),yMin:_(e,t),xMax:_(e,t),yMax:_(e,t)}}(e,r):"lineOrder"===n?function(e,t){return["INCREASING_Y"][N(e,t)]}(e,r):"float"===n?Q(e,r):"v2f"===n?function(e,t){return[Q(e,t),Q(e,t)]}(e,r):"v3f"===n?function(e,t){return[Q(e,t),Q(e,t),Q(e,t)]}(e,r):"int"===n?P(e,r):"rational"===n?function(e,t){return[P(e,t),_(e,t)]}(e,r):"timecode"===n?function(e,t){return[_(e,t),_(e,t)]}(e,r):"preview"===n?(r.value+=s,"skipped"):void(r.value+=s)}const V=new DataView(e),q=new Uint8Array(e),z={value:0},$=function(e,t,r){const n={};if(20000630!=e.getUint32(0,!0))throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";n.version=e.getUint8(4);const s=e.getUint8(5);n.spec={singleTile:!!(2&s),longName:!!(4&s),deepFormat:!!(8&s),multiPart:!!(16&s)},r.value=8;for(var a=!0;a;){var o=L(t,r);if(0==o)a=!1;else{var i=L(t,r),A=W(e,t,r,i,_(e,r));void 0===A?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${i}'.`):n[o]=A}}if(0!=(-5&s))throw console.error("EXRHeader:",n),"THREE.EXRLoader: provided file is currently unsupported.";return n}(V,e,z),ee=function(e,t,r,n,s){const a={size:0,viewer:t,array:r,offset:n,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[Sr?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":a.lines=1,a.uncompress=T;break;case"RLE_COMPRESSION":a.lines=1,a.uncompress=x;break;case"ZIPS_COMPRESSION":a.lines=1,a.uncompress=J;break;case"ZIP_COMPRESSION":a.lines=16,a.uncompress=J;break;case"PIZ_COMPRESSION":a.lines=32,a.uncompress=S;break;case"PXR24_COMPRESSION":a.lines=16,a.uncompress=O;break;case"DWAA_COMPRESSION":a.lines=32,a.uncompress=U;break;case"DWAB_COMPRESSION":a.lines=256,a.uncompress=U;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(a.scanlineBlockSize=a.lines,1==a.type)switch(s){case Ge:a.getter=Z,a.inputSize=2;break;case Re:a.getter=Y,a.inputSize=2}else{if(2!=a.type)throw"EXRLoader.parse: unsupported pixelType "+a.type+" for "+e.compression+".";switch(s){case Ge:a.getter=Q,a.inputSize=4;break;case Re:a.getter=X,a.inputSize=4}}a.blockCount=(e.dataWindow.yMax+1)/a.scanlineBlockSize;for(var o=0;o<a.blockCount;o++)k(t,n);a.outputChannels=3==a.channels?4:a.channels;const i=a.width*a.height*a.outputChannels;switch(s){case Ge:a.byteArray=new Float32Array(i),a.channels<a.outputChannels&&a.byteArray.fill(1,0,i);break;case Re:a.byteArray=new Uint16Array(i),a.channels<a.outputChannels&&a.byteArray.fill(15360,0,i);break;default:console.error("THREE.EXRLoader: unsupported type: ",s)}return a.bytesPerLine=a.width*a.inputSize*a.channels,4==a.outputChannels?a.format=ye:a.format=we,Sr?a.colorSpace="srgb-linear":a.encoding=3e3,a}($,V,q,z,this.type),te={value:0},re={R:0,G:1,B:2,A:3,Y:0};for(let ne=0;ne<ee.height/ee.scanlineBlockSize;ne++){const e=_(V,z);ee.size=_(V,z),ee.lines=e+ee.scanlineBlockSize>ee.height?ee.height-e:ee.scanlineBlockSize;const t=ee.size<ee.lines*ee.bytesPerLine?ee.uncompress(ee):T(ee);z.value+=ee.size;for(let r=0;r<ee.scanlineBlockSize;r++){const e=r+ne*ee.scanlineBlockSize;if(e>=ee.height)break;for(let n=0;n<ee.channels;n++){const s=re[$.channels[n].name];for(let a=0;a<ee.width;a++){te.value=(r*(ee.channels*ee.width)+n*ee.width+a)*ee.inputSize;const o=(ee.height-1-e)*(ee.width*ee.outputChannels)+a*ee.outputChannels+s;ee.byteArray[o]=ee.getter(t,te)}}}}return{header:$,width:ee.width,height:ee.height,data:ee.byteArray,format:ee.format,[Sr?"colorSpace":"encoding"]:ee[Sr?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,r,n){return super.load(e,(function(e,r){Sr?e.colorSpace=r.colorSpace:e.encoding=r.encoding,e.minFilter=P,e.magFilter=P,e.generateMipmaps=!1,e.flipY=!1,t&&t(e,r)}),r,n)}}const Ur=new WeakMap;class Lr extends E{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,n){const s=new F(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(e=>{const r={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,r).then(t).catch(n)}),r,n)}decodeDracoFile(e,t,r,n){const s={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const i in t.attributeTypes){const e=t.attributeTypes[i];void 0!==e.BYTES_PER_ELEMENT&&(t.attributeTypes[i]=e.name)}const r=JSON.stringify(t);if(Ur.has(e)){const t=Ur.get(e);if(t.key===r)return t.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n;const s=this.workerNextTaskID++,a=e.byteLength,o=this._getWorker(s,a).then((r=>(n=r,new Promise(((r,a)=>{n._callbacks[s]={resolve:r,reject:a},n.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))))).then((e=>this._createGeometry(e.geometry)));return o.catch((()=>!0)).then((()=>{n&&s&&this._releaseTask(n,s)})),Ur.set(e,{key:r,promise:o}),o}_createGeometry(e){const t=new Y;e.index&&t.setIndex(new U(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r],s=n.name,a=n.array,o=n.itemSize;t.setAttribute(s,new U(a,o))}return t}_loadLibrary(e,t){const r=new F(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise(((t,n)=>{r.load(e,t,void 0,n)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then((t=>{const r=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const n=Pr.toString(),s=["/* draco decoder */",r,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([s]))})),this.decoderPending}_getWorker(e,t){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const r=t.data;switch(r.type){case"decode":e._callbacks[r.id].resolve(r);break;case"error":e._callbacks[r.id].reject(r);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+r.type+'"')}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r}))}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map((e=>e._taskLoad)))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Pr(){let e,t;function r(e,t,r,n,s,a){const o=a.num_components(),i=r.num_points()*o,A=i*s.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,s),l=e._malloc(A);t.GetAttributeDataArrayForAllPoints(r,a,c,A,l);const u=new s(e.HEAPF32.buffer,l,i).slice();return e._free(l),{name:n,array:u,itemSize:o}}onmessage=function(n){const s=n.data;switch(s.type){case"init":e=s.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const n=s.buffer,a=s.taskConfig;t.then((e=>{const t=e.draco,o=new t.Decoder,i=new t.DecoderBuffer;i.Init(new Int8Array(n),n.byteLength);try{const e=function(e,t,n,s){const a=s.attributeIDs,o=s.attributeTypes;let i,A;const c=t.GetEncodedGeometryType(n);if(c===e.TRIANGULAR_MESH)i=new e.Mesh,A=t.DecodeBufferToMesh(n,i);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");i=new e.PointCloud,A=t.DecodeBufferToPointCloud(n,i)}if(!A.ok()||0===i.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+A.error_msg());const l={index:null,attributes:[]};for(const u in a){const n=self[o[u]];let A,c;if(s.useUniqueIDs)c=a[u],A=t.GetAttributeByUniqueId(i,c);else{if(c=t.GetAttributeId(i,e[a[u]]),-1===c)continue;A=t.GetAttribute(i,c)}l.attributes.push(r(e,t,i,u,n,A))}c===e.TRIANGULAR_MESH&&(l.index=function(e,t,r){const n=r.num_faces(),s=3*n,a=4*s,o=e._malloc(a);t.GetTrianglesUInt32Array(r,a,o);const i=new Uint32Array(e.HEAPF32.buffer,o,s).slice();return e._free(o),{array:i,itemSize:1}}(e,t,i));return e.destroy(i),l}(t,o,i,a),n=e.attributes.map((e=>e.array.buffer));e.index&&n.push(e.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:e},n)}catch(A){console.error(A),self.postMessage({type:"error",id:s.id,error:A.message})}finally{t.destroy(i),t.destroy(o)}}))}}}let _r;const Kr=()=>{if(_r)return _r;const e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!=typeof WebAssembly)return{supported:!1};let r,n="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";WebAssembly.validate(e)&&(n="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");const s=WebAssembly.instantiate(function(e){const r=new Uint8Array(e.length);for(let t=0;t<e.length;++t){const n=e.charCodeAt(t);r[t]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}let n=0;for(let s=0;s<e.length;++s)r[n++]=r[s]<60?t[r[s]]:64*(r[s]-60)+r[++s];return r.buffer.slice(0,n)}(n),{}).then((e=>{r=e.instance,r.exports.__wasm_call_ctors()}));function a(e,t,n,s,a,o){const i=r.exports.sbrk,A=n+3&-4,c=i(A*s),l=i(a.length),u=new Uint8Array(r.exports.memory.buffer);u.set(a,l);const B=e(c,n,s,l,a.length);if(0===B&&o&&o(c,A,s),t.set(u.subarray(c,c+n*s)),i(c-i(0)),0!==B)throw new Error(`Malformed buffer data: ${B}`)}const o={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},i={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return _r={ready:s,supported:!0,decodeVertexBuffer(e,t,n,s,i){a(r.exports.meshopt_decodeVertexBuffer,e,t,n,s,r.exports[o[i]])},decodeIndexBuffer(e,t,n,s){a(r.exports.meshopt_decodeIndexBuffer,e,t,n,s)},decodeIndexSequence(e,t,n,s){a(r.exports.meshopt_decodeIndexSequence,e,t,n,s)},decodeGltfBuffer(e,t,n,s,A,c){a(r.exports[i[A]],e,t,n,s,r.exports[o[c]])}},_r};let Nr=null,kr="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Qr(e=!0,t=!0,r){return n=>{r&&r(n),e&&(Nr||(Nr=new Lr),Nr.setDecoderPath("string"==typeof e?e:kr),n.setDRACOLoader(Nr)),t&&n.setMeshoptDecoder(Kr())}}const Xr=(e,t,r,n)=>be(Ot,e,Qr(t,r,n));Xr.preload=(e,t,r,n)=>be.preload(Ot,e,Qr(t,r,n)),Xr.clear=e=>be.clear(Ot,e),Xr.setDecoderPath=e=>{kr=e};const jr=(e,t,r)=>{let n;switch(e){case Ne:n=new Uint8ClampedArray(t*r*4);break;case Re:n=new Uint16Array(t*r*4);break;case Ke:n=new Uint32Array(t*r*4);break;case _e:n=new Int8Array(t*r*4);break;case Pe:n=new Int16Array(t*r*4);break;case Le:n=new Int32Array(t*r*4);break;case Ge:n=new Float32Array(t*r*4);break;default:throw new Error("Unsupported data type")}return n};let Yr;class Zr{constructor(e){var t,r,n,s,a,o,i,A,c,l,u,B,d,h,f,p;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(Rn){throw this._renderer.setRenderTarget(null),Rn}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const m={format:ye,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:void 0!==(null===(t=e.renderTargetOptions)||void 0===t?void 0:t.anisotropy)?null===(r=e.renderTargetOptions)||void 0===r?void 0:r.anisotropy:1,generateMipmaps:void 0!==(null===(n=e.renderTargetOptions)||void 0===n?void 0:n.generateMipmaps)&&(null===(s=e.renderTargetOptions)||void 0===s?void 0:s.generateMipmaps),magFilter:void 0!==(null===(a=e.renderTargetOptions)||void 0===a?void 0:a.magFilter)?null===(o=e.renderTargetOptions)||void 0===o?void 0:o.magFilter:P,minFilter:void 0!==(null===(i=e.renderTargetOptions)||void 0===i?void 0:i.minFilter)?null===(A=e.renderTargetOptions)||void 0===A?void 0:A.minFilter:P,samples:void 0!==(null===(c=e.renderTargetOptions)||void 0===c?void 0:c.samples)?null===(l=e.renderTargetOptions)||void 0===l?void 0:l.samples:void 0,wrapS:void 0!==(null===(u=e.renderTargetOptions)||void 0===u?void 0:u.wrapS)?null===(B=e.renderTargetOptions)||void 0===B?void 0:B.wrapS:Be,wrapT:void 0!==(null===(d=e.renderTargetOptions)||void 0===d?void 0:d.wrapT)?null===(h=e.renderTargetOptions)||void 0===h?void 0:h.wrapT:Be};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=Zr.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new He,this._camera=new re,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!((e,t,r,n)=>{if(void 0!==Yr)return Yr;const s=new xe(1,1,n);t.setRenderTarget(s);const a=new C(new Te,new D({color:16777215}));t.render(a,r),t.setRenderTarget(null);const o=jr(e,s.width,s.height);return t.readRenderTargetPixels(s,0,0,s.width,s.height,o),s.dispose(),a.geometry.dispose(),a.material.dispose(),Yr=0!==o[0],Yr})(this._type,this._renderer,this._camera,m)){let e;if(this._type===Re)e=this._renderer.extensions.has("EXT_color_buffer_float")?Ge:void 0;void 0!==e?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ge}`),this._type=e):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new C(new Te,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new xe(this.width,this.height,m),this._renderTarget.texture.mapping=void 0!==(null===(f=e.renderTargetOptions)||void 0===f?void 0:f.mapping)?null===(p=e.renderTargetOptions)||void 0===p?void 0:p.mapping:Je}static instantiateRenderer(){const e=new Se;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=jr(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Oe(this.toArray(),this.width,this.height,ye,this._type,(null==e?void 0:e.mapping)||Je,(null==e?void 0:e.wrapS)||Be,(null==e?void 0:e.wrapT)||Be,(null==e?void 0:e.magFilter)||P,(null==e?void 0:e.minFilter)||P,(null==e?void 0:e.anisotropy)||1,Ue);return t.generateMipmaps=void 0!==(null==e?void 0:e.generateMipmaps)&&(null==e?void 0:e.generateMipmaps),t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof m&&Object.values(this.material.uniforms).forEach((e=>{e.value instanceof pe&&e.value.dispose()})),Object.values(this.material).forEach((e=>{e instanceof pe&&e.dispose()})),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class Wr extends m{constructor({gamma:e,offsetHdr:t,offsetSdr:r,gainMapMin:n,gainMapMax:s,maxDisplayBoost:a,hdrCapacityMin:o,hdrCapacityMax:i,sdr:A,gainMap:c}){super({name:"GainMapDecoderMaterial",vertexShader:"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\n// min half float value\n#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )\n// max half float value\n#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )\n\nuniform sampler2D sdr;\nuniform sampler2D gainMap;\nuniform vec3 gamma;\nuniform vec3 offsetHdr;\nuniform vec3 offsetSdr;\nuniform vec3 gainMapMin;\nuniform vec3 gainMapMax;\nuniform float weightFactor;\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec3 rgb = texture2D( sdr, vUv ).rgb;\n  vec3 recovery = texture2D( gainMap, vUv ).rgb;\n  vec3 logRecovery = pow( recovery, gamma );\n  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;\n  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;\n  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));\n  gl_FragColor = vec4( clampedHdrColor , 1.0 );\n}\n",uniforms:{sdr:{value:A},gainMap:{value:c},gamma:{value:new H(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:(new H).fromArray(t)},offsetSdr:{value:(new H).fromArray(r)},gainMapMin:{value:(new H).fromArray(n)},gainMapMax:{value:(new H).fromArray(s)},weightFactor:{value:(Math.log2(a)-o)/(i-o)}},blending:je,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=o,this._hdrCapacityMax=i,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class Vr extends Error{}class qr extends Error{}const zr=(e,t,r)=>{const n=new RegExp(`${t}="([^"]*)"`,"i").exec(e);if(n)return n[1];const s=new RegExp(`<${t}[^>]*>([\\s\\S]*?)</${t}>`,"i").exec(e);if(s){const e=s[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return e&&3===e.length?e.map((e=>e.replace(/<\/?rdf:li>/g,""))):s[1].trim()}if(void 0!==r)return r;throw new Error(`Can't find ${t} in gainmap metadata`)};class $r{constructor(e){this.options={debug:!(!e||void 0===e.debug)&&e.debug,extractFII:!e||void 0===e.extractFII||e.extractFII,extractNonFII:!e||void 0===e.extractNonFII||e.extractNonFII}}extract(e){return new Promise(((t,r)=>{const n=this.options.debug,s=new DataView(e.buffer);if(65496!==s.getUint16(0))return void r(new Error("Not a valid jpeg"));const a=s.byteLength;let o,i=2,A=0;for(;i<a;){if(++A>250)return void r(new Error(`Found no marker after ${A} loops `));if(255!==s.getUint8(i))return void r(new Error(`Not a valid marker at offset 0x${i.toString(16)}, found: 0x${s.getUint8(i).toString(16)}`));if(o=s.getUint8(i+1),n&&console.log(`Marker: ${o.toString(16)}`),226===o){n&&console.log("Found APP2 marker (0xffe2)");const e=i+4;if(1297106432===s.getUint32(e)){const n=e+4;let a;if(18761===s.getUint16(n))a=!1;else{if(19789!==s.getUint16(n))return void r(new Error("No valid endianness marker found in TIFF header"));a=!0}if(42!==s.getUint16(n+2,!a))return void r(new Error("Not valid TIFF data! (no 0x002A marker)"));const o=s.getUint32(n+4,!a);if(o<8)return void r(new Error("Not valid TIFF data! (First offset less than 8)"));const i=n+o,A=s.getUint16(i,!a),c=i+2;let l=0;for(let e=c;e<c+12*A;e+=12)45057===s.getUint16(e,!a)&&(l=s.getUint32(e+8,!a));const u=i+2+12*A+4,B=[];for(let e=u;e<u+16*l;e+=16){const t={MPType:s.getUint32(e,!a),size:s.getUint32(e+4,!a),dataOffset:s.getUint32(e+8,!a),dependantImages:s.getUint32(e+12,!a),start:-1,end:-1,isFII:!1};t.dataOffset?(t.start=n+t.dataOffset,t.isFII=!1):(t.start=0,t.isFII=!0),t.end=t.start+t.size,B.push(t)}if(this.options.extractNonFII&&B.length){const e=new Blob([s]),r=[];for(const t of B){if(t.isFII&&!this.options.extractFII)continue;const n=e.slice(t.start,t.end+1,"image/jpeg");r.push(n)}t(r)}}}i+=2+s.getUint16(i+2)}}))}}const en=e=>l(void 0,null,(function*(){const t=(e=>{let t;t="undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):e.toString();let r=t.indexOf("<x:xmpmeta");for(;-1!==r;){const e=t.indexOf("x:xmpmeta>",r),n=t.slice(r,e+10);try{const e=zr(n,"hdrgm:GainMapMin","0"),t=zr(n,"hdrgm:GainMapMax"),r=zr(n,"hdrgm:Gamma","1"),s=zr(n,"hdrgm:OffsetSDR","0.015625"),a=zr(n,"hdrgm:OffsetHDR","0.015625"),o=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(n),i=o?o[1]:"0",A=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(n);if(!A)throw new Error("Incomplete gainmap metadata");const c=A[1];return{gainMapMin:Array.isArray(e)?e.map((e=>parseFloat(e))):[parseFloat(e),parseFloat(e),parseFloat(e)],gainMapMax:Array.isArray(t)?t.map((e=>parseFloat(e))):[parseFloat(t),parseFloat(t),parseFloat(t)],gamma:Array.isArray(r)?r.map((e=>parseFloat(e))):[parseFloat(r),parseFloat(r),parseFloat(r)],offsetSdr:Array.isArray(s)?s.map((e=>parseFloat(e))):[parseFloat(s),parseFloat(s),parseFloat(s)],offsetHdr:Array.isArray(a)?a.map((e=>parseFloat(e))):[parseFloat(a),parseFloat(a),parseFloat(a)],hdrCapacityMin:parseFloat(i),hdrCapacityMax:parseFloat(c)}}catch(Rn){}r=t.indexOf("<x:xmpmeta",e)}})(e);if(!t)throw new qr("Gain map XMP metadata not found");const r=new $r({extractFII:!0,extractNonFII:!0}),n=yield r.extract(e);if(2!==n.length)throw new Vr("Gain map recovery image not found");return{sdr:new Uint8Array(yield n[0].arrayBuffer()),gainMap:new Uint8Array(yield n[1].arrayBuffer()),metadata:t}})),tn=e=>new Promise(((t,r)=>{const n=document.createElement("img");n.onload=()=>{t(n)},n.onerror=e=>{r(e)},n.src=URL.createObjectURL(e)}));class rn extends E{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new ke}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new Wr({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new pe,sdr:new pe});return new Zr({width:16,height:16,type:Re,colorSpace:Ue,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}render(e,t,r,n){return l(this,null,(function*(){const s=n?new Blob([n],{type:"image/jpeg"}):void 0,a=new Blob([r],{type:"image/jpeg"});let o,i,A=!1;if("undefined"==typeof createImageBitmap){const e=yield Promise.all([s?tn(s):Promise.resolve(void 0),tn(a)]);i=e[0],o=e[1],A=!0}else{const e=yield Promise.all([s?createImageBitmap(s,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:"flipY"})]);i=e[0],o=e[1]}const c=new pe(i||new ImageData(2,2),Je,Be,Be,P,Qe,ye,Ne,1,Ue);c.flipY=A,c.needsUpdate=!0;const l=new pe(o,Je,Be,Be,P,Qe,ye,Ne,1,Xe);l.flipY=A,l.needsUpdate=!0,e.width=o.width,e.height=o.height,e.material.gainMap=c,e.material.sdr=l,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}))}}class nn extends rn{load([e,t,r],n,s,a){const o=this.prepareQuadRenderer();let i,A,c;const u=()=>l(this,null,(function*(){if(i&&A&&c){try{yield this.render(o,c,i,A)}catch(s){return this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(r),"function"==typeof a&&a(s),void o.disposeOnDemandRenderer()}"function"==typeof n&&n(o),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(r),o.disposeOnDemandRenderer()}}));let B=!0,d=0,h=0,f=!0,C=0,p=0,m=!0,g=0,E=0;const M=()=>{if("function"==typeof s){s(new ProgressEvent("progress",{lengthComputable:B&&f&&m,loaded:h+p+E,total:d+C+g}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(r);const I=new F(this._internalLoadingManager);I.setResponseType("arraybuffer"),I.setRequestHeader(this.requestHeader),I.setPath(this.path),I.setWithCredentials(this.withCredentials),I.load(e,(e=>l(this,null,(function*(){if("string"==typeof e)throw new Error("Invalid sdr buffer");i=e,yield u()}))),(e=>{B=e.lengthComputable,h=e.loaded,d=e.total,M()}),(t=>{this.manager.itemError(e),"function"==typeof a&&a(t)}));const v=new F(this._internalLoadingManager);v.setResponseType("arraybuffer"),v.setRequestHeader(this.requestHeader),v.setPath(this.path),v.setWithCredentials(this.withCredentials),v.load(t,(e=>l(this,null,(function*(){if("string"==typeof e)throw new Error("Invalid gainmap buffer");A=e,yield u()}))),(e=>{f=e.lengthComputable,p=e.loaded,C=e.total,M()}),(e=>{this.manager.itemError(t),"function"==typeof a&&a(e)}));const R=new F(this._internalLoadingManager);return R.setRequestHeader(this.requestHeader),R.setPath(this.path),R.setWithCredentials(this.withCredentials),R.load(r,(e=>l(this,null,(function*(){if("string"!=typeof e)throw new Error("Invalid metadata string");c=JSON.parse(e),yield u()}))),(e=>{m=e.lengthComputable,E=e.loaded,g=e.total,M()}),(e=>{this.manager.itemError(r),"function"==typeof a&&a(e)})),o}}class sn extends rn{load(e,t,r,n){const s=this.prepareQuadRenderer(),a=new F(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,(r=>l(this,null,(function*(){if("string"==typeof r)throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const a=new Uint8Array(r);let o,i,A;try{const e=yield en(a);o=e.sdr,i=e.gainMap,A=e.metadata}catch(Rn){if(!(Rn instanceof qr||Rn instanceof Vr))throw Rn;console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),A={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},o=a}try{yield this.render(s,A,o,i)}catch(c){return this.manager.itemError(e),"function"==typeof n&&n(c),void s.disposeOnDemandRenderer()}"function"==typeof t&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()}))),r,(t=>{this.manager.itemError(e),"function"==typeof n&&n(t)})),s}}const an={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},on="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",An=e=>Array.isArray(e),cn=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function ln({files:e=cn,path:t="",preset:r,colorSpace:n,extensions:s}={}){r&&(dn(r),e=an[r],t=on);const a=An(e),{extension:o,isCubemap:i}=hn(e),A=fn(o);if(!A)throw new Error("useEnvironment: Unrecognized file extension: "+e);const c=Ye((e=>e.gl));u.useLayoutEffect((()=>{"webp"!==o&&"jpg"!==o&&"jpeg"!==o||c.domElement.addEventListener("webglcontextlost",(function(){be.clear(A,a?[e]:e)}),{once:!0})}),[e,c.domElement]);const l=be(A,a?[e]:e,(e=>{"webp"!==o&&"jpg"!==o&&"jpeg"!==o||e.setRenderer(c),null==e.setPath||e.setPath(t),s&&s(e)}));let B=a?l[0]:l;var d;"jpg"!==o&&"jpeg"!==o&&"webp"!==o||(B=null==(d=B.renderTarget)?void 0:d.texture);return B.mapping=i?Ze:We,B.colorSpace=null!=n?n:i?"srgb":"srgb-linear",B}const un={files:cn,path:"",preset:void 0,extensions:void 0};ln.preload=e=>{const t=i(i({},un),e);let{files:r,path:n=""}=t;const{preset:s,extensions:a}=t;s&&(dn(s),r=an[s],n=on);const{extension:o}=hn(r);if("webp"===o||"jpg"===o||"jpeg"===o)throw new Error("useEnvironment: Preloading gainmaps is not supported");const A=fn(o);if(!A)throw new Error("useEnvironment: Unrecognized file extension: "+r);be.preload(A,An(r)?[r]:r,(e=>{null==e.setPath||e.setPath(n),a&&a(e)}))};const Bn={files:cn,preset:void 0};function dn(e){if(!(e in an))throw new Error("Preset must be one of: "+Object.keys(an).join(", "))}function hn(e){var t;const r=An(e)&&6===e.length,n=An(e)&&3===e.length&&e.some((e=>e.endsWith("json"))),s=An(e)?e[0]:e;return{extension:r?"cube":n?"webp":s.startsWith("data:application/exr")?"exr":s.startsWith("data:application/hdr")?"hdr":s.startsWith("data:image/jpeg")?"jpg":null==(t=s.split(".").pop())||null==(t=t.split("?"))||null==(t=t.shift())?void 0:t.toLowerCase(),isCubemap:r,isGainmap:n}}function fn(e){return"cube"===e?Ve:"hdr"===e?Jr:"exr"===e?Or:"jpg"===e||"jpeg"===e?sn:"webp"===e?nn:null}ln.clear=e=>{const t=i(i({},Bn),e);let{files:r}=t;const{preset:n}=t;n&&(dn(n),r=an[n]);const{extension:s}=hn(r),a=fn(s);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+r);be.clear(a,An(r)?[r]:r)};const Cn=e=>{return(t=e).current&&t.current.isScene?e.current:e;var t};function pn(e,t,r,n,s={}){var a,o,A,c;s=i({backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0]},s);const l=Cn(t||r),u=l.background,B=l.environment,d={backgroundBlurriness:l.backgroundBlurriness,backgroundIntensity:l.backgroundIntensity,backgroundRotation:null!==(a=null==(o=l.backgroundRotation)||null==o.clone?void 0:o.clone())&&void 0!==a?a:[0,0,0],environmentIntensity:l.environmentIntensity,environmentRotation:null!==(A=null==(c=l.environmentRotation)||null==c.clone?void 0:c.clone())&&void 0!==A?A:[0,0,0]};return"only"!==e&&(l.environment=n),e&&(l.background=n),rt(l,s),()=>{"only"!==e&&(l.environment=B),e&&(l.background=u),rt(l,d)}}function mn(e){var t=e,{scene:r,background:n=!1,map:s}=t,a=A(t,["scene","background","map"]);const o=Ye((e=>e.scene));return u.useLayoutEffect((()=>{if(s)return pn(n,r,o,s,a)})),null}function gn(e){var t=e,{background:r=!1,scene:n,blur:s,backgroundBlurriness:a,backgroundIntensity:o,backgroundRotation:i,environmentIntensity:c,environmentRotation:l}=t;const B=ln(A(t,["background","scene","blur","backgroundBlurriness","backgroundIntensity","backgroundRotation","environmentIntensity","environmentRotation"])),d=Ye((e=>e.scene));return u.useLayoutEffect((()=>pn(r,n,d,B,{backgroundBlurriness:null!=s?s:a,backgroundIntensity:o,backgroundRotation:i,environmentIntensity:c,environmentRotation:l}))),u.useEffect((()=>()=>{B.dispose()}),[B]),null}function En({children:e,near:t=.1,far:r=1e3,resolution:n=256,frames:s=1,map:a,background:o=!1,blur:i,backgroundBlurriness:A,backgroundIntensity:c,backgroundRotation:l,environmentIntensity:B,environmentRotation:d,scene:h,files:f,path:C,preset:p,extensions:m}){const g=Ye((e=>e.gl)),E=Ye((e=>e.scene)),M=u.useRef(null),[F]=u.useState((()=>new He)),I=u.useMemo((()=>{const e=new qe(n);return e.texture.type=Re,e}),[n]);u.useEffect((()=>()=>{I.dispose()}),[I]),u.useLayoutEffect((()=>{if(1===s){const e=g.autoClear;g.autoClear=!0,M.current.update(g,F),g.autoClear=e}return pn(o,h,E,I.texture,{backgroundBlurriness:null!=i?i:A,backgroundIntensity:c,backgroundRotation:l,environmentIntensity:B,environmentRotation:d})}),[e,F,I.texture,h,E,o,s,g]);let v=1;return ze((()=>{if(s===1/0||v<s){const e=g.autoClear;g.autoClear=!0,M.current.update(g,F),g.autoClear=e,v++}})),u.createElement(u.Fragment,null,$e(u.createElement(u.Fragment,null,e,u.createElement("cubeCamera",{ref:M,args:[t,r,I]}),f||p?u.createElement(gn,{background:!0,files:f,preset:p,path:C,extensions:m}):a?u.createElement(mn,{background:!0,map:a,extensions:m}):null),F))}function Mn(e){var t,r,n,s;const a=ln(e),o=e.map||a;u.useMemo((()=>et({GroundProjectedEnvImpl:Tt})),[]),u.useEffect((()=>()=>{a.dispose()}),[a]);const i=u.useMemo((()=>[o]),[o]),A=null==(t=e.ground)?void 0:t.height,c=null==(r=e.ground)?void 0:r.radius,l=null!==(n=null==(s=e.ground)?void 0:s.scale)&&void 0!==n?n:1e3;return u.createElement(u.Fragment,null,u.createElement(mn,tt({},e,{map:o})),u.createElement("groundProjectedEnvImpl",{args:i,scale:l,height:A,radius:c}))}function Fn(e){return e.ground?u.createElement(Mn,e):e.map?u.createElement(mn,e):e.children?u.createElement(En,e):u.createElement(gn,e)}const In=class{static chainable(e){return(...t)=>(e(...t),this)}};c(In,"wrap",In.chainable((e=>{e.wrapS=K,e.wrapT=K}))),c(In,"repeat",In.chainable(((e,t)=>{e.repeat.set(t,t),e.offset.set(0,0)}))),c(In,"colorless",In.chainable((e=>{e.colorSpace=nt}))),c(In,"rerender",In.chainable((e=>{e.needsUpdate=!0})));let vn=In;export{Fn as E,vn as T,Xr as u};
//# sourceMappingURL=Textures-N61V2vZp.js.map
