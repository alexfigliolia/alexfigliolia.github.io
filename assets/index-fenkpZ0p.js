var t=Object.defineProperty,e=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(e,s,i)=>(((e,s,i)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i})(e,"symbol"!=typeof s?s+"":s,i),i);import{r,j as n,u as a}from"./index-BW91fhZy.js";import{g as h,a as l,u as c,_,K as d,q as m,i as p,Q as u,X as E,Y as g,p as O,V as y,h as T,j as f,W as C,C as v,n as x,f as U,x as S,G as A,A as w}from"./useLabsLoader-Ips9P70R.js";import{S as L}from"./useMenuButtonDelay-FqUex6AT.js";import{g as D}from"./index-b4RP9EQ6.js";import{T as P,u as R,E as k}from"./Textures-pXWXN2Ra.js";
/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const b=1,M=2,z=4,F=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,SCREEN_PAN:4,OFFSET:8,DOLLY:16,ZOOM:32,TOUCH_ROTATE:64,TOUCH_TRUCK:128,TOUCH_SCREEN_PAN:256,TOUCH_OFFSET:512,TOUCH_DOLLY:1024,TOUCH_ZOOM:2048,TOUCH_DOLLY_TRUCK:4096,TOUCH_DOLLY_SCREEN_PAN:8192,TOUCH_DOLLY_OFFSET:16384,TOUCH_DOLLY_ROTATE:32768,TOUCH_ZOOM_TRUCK:65536,TOUCH_ZOOM_OFFSET:131072,TOUCH_ZOOM_SCREEN_PAN:262144,TOUCH_ZOOM_ROTATE:524288}),H=0,N=1,V=-1;function Y(t){return t.isPerspectiveCamera}function j(t){return t.isOrthographicCamera}const Z=2*Math.PI,B=Math.PI/2,I=1e-5,K=Math.PI/180;function X(t,e,s){return Math.max(e,Math.min(s,t))}function W(t,e=I){return Math.abs(t)<e}function Q(t,e,s=I){return W(t-e,s)}function q(t,e){return Math.round(t/e)*e}function G(t){return isFinite(t)?t:t<0?-Number.MAX_VALUE:Number.MAX_VALUE}function J(t){return Math.abs(t)<Number.MAX_VALUE?t:t*(1/0)}function $(t,e,s,i,o=1/0,r){const n=2/(i=Math.max(1e-4,i)),a=n*r,h=1/(1+a+.48*a*a+.235*a*a*a);let l=t-e;const c=e,_=o*i;l=X(l,-_,_),e=t-l;const d=(s.value+n*l)*r;s.value=(s.value-n*d)*h;let m=e+(l+d)*h;return c-t>0==m>c&&(m=c,s.value=(m-c)/r),m}function tt(t,e,s,i,o=1/0,r,n){const a=2/(i=Math.max(1e-4,i)),h=a*r,l=1/(1+h+.48*h*h+.235*h*h*h);let c=e.x,_=e.y,d=e.z,m=t.x-c,p=t.y-_,u=t.z-d;const E=c,g=_,O=d,y=o*i,T=m*m+p*p+u*u;if(T>y*y){const t=Math.sqrt(T);m=m/t*y,p=p/t*y,u=u/t*y}c=t.x-m,_=t.y-p,d=t.z-u;const f=(s.x+a*m)*r,C=(s.y+a*p)*r,v=(s.z+a*u)*r;s.x=(s.x-a*f)*l,s.y=(s.y-a*C)*l,s.z=(s.z-a*v)*l,n.x=c+(m+f)*l,n.y=_+(p+C)*l,n.z=d+(u+v)*l;const x=E-t.x,U=g-t.y,S=O-t.z;return x*(n.x-E)+U*(n.y-g)+S*(n.z-O)>0&&(n.x=E,n.y=g,n.z=O,s.x=(n.x-E)/r,s.y=(n.y-g)/r,s.z=(n.z-O)/r),n}function et(t,e){e.set(0,0),t.forEach((t=>{e.x+=t.clientX,e.y+=t.clientY})),e.x/=t.length,e.y/=t.length}function st(t,e){return!!j(t)&&(console.warn(`${e} is not supported in OrthographicCamera`),!0)}class it{constructor(){this._listeners={}}addEventListener(t,e){const s=this._listeners;void 0===s[t]&&(s[t]=[]),-1===s[t].indexOf(e)&&s[t].push(e)}hasEventListener(t,e){const s=this._listeners;return void 0!==s[t]&&-1!==s[t].indexOf(e)}removeEventListener(t,e){const s=this._listeners[t];if(void 0!==s){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}removeAllEventListeners(t){t?Array.isArray(this._listeners[t])&&(this._listeners[t].length=0):this._listeners={}}dispatchEvent(t){const e=this._listeners[t.type];if(void 0!==e){t.target=this;const s=e.slice(0);for(let e=0,i=s.length;e<i;e++)s[e].call(this,t)}}}var ot;const rt=1/8,nt=/Mac/.test(null===(ot=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===ot?void 0:ot.platform);let at,ht,lt,ct,_t,dt,mt,pt,ut,Et,gt,Ot,yt,Tt,ft,Ct,vt,xt,Ut,St,At,wt,Lt,Dt=class t extends it{static install(t){at=t.THREE,ht=Object.freeze(new at.Vector3(0,0,0)),lt=Object.freeze(new at.Vector3(0,1,0)),ct=Object.freeze(new at.Vector3(0,0,1)),_t=new at.Vector2,dt=new at.Vector3,mt=new at.Vector3,pt=new at.Vector3,ut=new at.Vector3,Et=new at.Vector3,gt=new at.Vector3,Ot=new at.Vector3,yt=new at.Vector3,Tt=new at.Vector3,ft=new at.Spherical,Ct=new at.Spherical,vt=new at.Box3,xt=new at.Box3,Ut=new at.Sphere,St=new at.Quaternion,At=new at.Quaternion,wt=new at.Matrix4,Lt=new at.Raycaster}static get ACTION(){return F}set verticalDragToForward(t){console.warn("camera-controls: `verticalDragToForward` was removed. Use `mouseButtons.left = CameraControls.ACTION.SCREEN_PAN` instead.")}constructor(e,s){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=F.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=H,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new at.Vector3,this._focalOffsetVelocity=new at.Vector3,this._zoomVelocity={value:0},this._truckInternal=(t,e,s,i)=>{let o,r;if(Y(this._camera)){const s=dt.copy(this._camera.position).sub(this._target),i=this._camera.getEffectiveFOV()*K,n=s.length()*Math.tan(.5*i);o=this.truckSpeed*t*n/this._elementRect.height,r=this.truckSpeed*e*n/this._elementRect.height}else{if(!j(this._camera))return;{const s=this._camera;o=this.truckSpeed*t*(s.right-s.left)/s.zoom/this._elementRect.width,r=this.truckSpeed*e*(s.top-s.bottom)/s.zoom/this._elementRect.height}}i?(s?this.setFocalOffset(this._focalOffsetEnd.x+o,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(o,0,!0),this.forward(-r,!0)):s?this.setFocalOffset(this._focalOffsetEnd.x+o,this._focalOffsetEnd.y+r,this._focalOffsetEnd.z,!0):this.truck(o,r,!0)},this._rotateInternal=(t,e)=>{const s=Z*this.azimuthRotateSpeed*t/this._elementRect.height,i=Z*this.polarRotateSpeed*e/this._elementRect.height;this.rotate(s,i,!0)},this._dollyInternal=(t,e,s)=>{const i=Math.pow(.95,-t*this.dollySpeed),o=this._sphericalEnd.radius,r=this._sphericalEnd.radius*i,n=X(r,this.minDistance,this.maxDistance),a=n-r;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(r,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(a,!0),this._dollyToNoClamp(n,!0)):this._dollyToNoClamp(n,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?r:n)-o,this._dollyControlCoord.set(e,s)),this._lastDollyDirection=Math.sign(-t)},this._zoomInternal=(t,e,s)=>{const i=Math.pow(.95,t*this.dollySpeed),o=this._zoom,r=this._zoom*i;this.zoomTo(r,!0),this.dollyToCursor&&(this._changedZoom+=r-o,this._dollyControlCoord.set(e,s))},void 0===at&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=(new at.Quaternion).setFromUnitVectors(this._camera.up,lt),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=F.NONE,this._target=new at.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new at.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new at.Spherical).setFromVector3(dt.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new at.Vector3,new at.Vector3,new at.Vector3,new at.Vector3],this._updateNearPlaneCorners(),this._boundary=new at.Box3(new at.Vector3(-1/0,-1/0,-1/0),new at.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new at.Vector2,this.mouseButtons={left:F.ROTATE,middle:F.DOLLY,right:F.TRUCK,wheel:Y(this._camera)?F.DOLLY:j(this._camera)?F.ZOOM:F.NONE},this.touches={one:F.TOUCH_ROTATE,two:Y(this._camera)?F.TOUCH_DOLLY_TRUCK:j(this._camera)?F.TOUCH_ZOOM_TRUCK:F.NONE,three:F.TOUCH_TRUCK};const i=new at.Vector2,o=new at.Vector2,r=new at.Vector2,n=t=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const e=this._domElement.getBoundingClientRect(),s=t.clientX/e.width,i=t.clientY/e.height;if(s<this._interactiveArea.left||s>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}const e="mouse"!==t.pointerType?null:(t.buttons&b)===b?b:(t.buttons&z)===z?z:(t.buttons&M)===M?M:null;if(null!==e){const t=this._findPointerByMouseButton(e);t&&this._disposePointer(t)}if((t.buttons&b)===b&&this._lockedPointer)return;const s={pointerId:t.pointerId,clientX:t.clientX,clientY:t.clientY,deltaX:0,deltaY:0,mouseButton:e};this._activePointers.push(s),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),this._isDragging=!0,d(t)},a=t=>{t.cancelable&&t.preventDefault();const e=t.pointerId,s=this._lockedPointer||this._findPointerById(e);if(s){if(s.clientX=t.clientX,s.clientY=t.clientY,s.deltaX=t.movementX,s.deltaY=t.movementY,this._state=0,"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(t.buttons&b)===b)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(t.buttons&z)===z&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(t.buttons&M)===M&&(this._state=this._state|this.mouseButtons.right);m()}},h=t=>{const e=this._findPointerById(t.pointerId);if(!e||e!==this._lockedPointer){if(e&&this._disposePointer(e),"touch"===t.pointerType)switch(this._activePointers.length){case 0:this._state=F.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=F.NONE;p()}};let l=-1;const c=t=>{if(!this._domElement)return;if(!this._enabled||this.mouseButtons.wheel===F.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const e=this._domElement.getBoundingClientRect(),s=t.clientX/e.width,i=t.clientY/e.height;if(s<this._interactiveArea.left||s>this._interactiveArea.right||i<this._interactiveArea.top||i>this._interactiveArea.bottom)return}if(t.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===F.ROTATE||this.mouseButtons.wheel===F.TRUCK){const t=performance.now();l-t<1e3&&this._getClientRect(this._elementRect),l=t}const e=nt?-1:-3,s=1===t.deltaMode||t.ctrlKey?t.deltaY/e:t.deltaY/(10*e),i=this.dollyToCursor?(t.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,o=this.dollyToCursor?(t.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case F.ROTATE:this._rotateInternal(t.deltaX,t.deltaY),this._isUserControllingRotate=!0;break;case F.TRUCK:this._truckInternal(t.deltaX,t.deltaY,!1,!1),this._isUserControllingTruck=!0;break;case F.SCREEN_PAN:this._truckInternal(t.deltaX,t.deltaY,!1,!0),this._isUserControllingTruck=!0;break;case F.OFFSET:this._truckInternal(t.deltaX,t.deltaY,!0,!1),this._isUserControllingOffset=!0;break;case F.DOLLY:this._dollyInternal(-s,i,o),this._isUserControllingDolly=!0;break;case F.ZOOM:this._zoomInternal(-s,i,o),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},_=e=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===t.ACTION.NONE){const t=e instanceof PointerEvent?e.pointerId:0,s=this._findPointerById(t);return s&&this._disposePointer(s),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),void this._domElement.ownerDocument.removeEventListener("pointerup",h)}e.preventDefault()}},d=t=>{if(!this._enabled)return;et(this._activePointers,_t),this._getClientRect(this._elementRect),i.copy(_t),o.copy(_t);if(this._activePointers.length>=2){const t=_t.x-this._activePointers[1].clientX,e=_t.y-this._activePointers[1].clientY,s=Math.sqrt(t*t+e*e);r.set(0,s);const i=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),n=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);o.set(i,n)}if(this._state=0,t)if("pointerType"in t&&"touch"===t.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._lockedPointer||(t.buttons&b)!==b||(this._state=this._state|this.mouseButtons.left),(t.buttons&z)===z&&(this._state=this._state|this.mouseButtons.middle),(t.buttons&M)===M&&(this._state=this._state|this.mouseButtons.right);else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);(this._state&F.ROTATE)!==F.ROTATE&&(this._state&F.TOUCH_ROTATE)!==F.TOUCH_ROTATE&&(this._state&F.TOUCH_DOLLY_ROTATE)!==F.TOUCH_DOLLY_ROTATE&&(this._state&F.TOUCH_ZOOM_ROTATE)!==F.TOUCH_ZOOM_ROTATE||(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),(this._state&F.TRUCK)!==F.TRUCK&&(this._state&F.SCREEN_PAN)!==F.SCREEN_PAN&&(this._state&F.TOUCH_TRUCK)!==F.TOUCH_TRUCK&&(this._state&F.TOUCH_SCREEN_PAN)!==F.TOUCH_SCREEN_PAN&&(this._state&F.TOUCH_DOLLY_TRUCK)!==F.TOUCH_DOLLY_TRUCK&&(this._state&F.TOUCH_DOLLY_SCREEN_PAN)!==F.TOUCH_DOLLY_SCREEN_PAN&&(this._state&F.TOUCH_ZOOM_TRUCK)!==F.TOUCH_ZOOM_TRUCK&&(this._state&F.TOUCH_ZOOM_SCREEN_PAN)!==F.TOUCH_DOLLY_SCREEN_PAN||(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),(this._state&F.DOLLY)!==F.DOLLY&&(this._state&F.TOUCH_DOLLY)!==F.TOUCH_DOLLY&&(this._state&F.TOUCH_DOLLY_TRUCK)!==F.TOUCH_DOLLY_TRUCK&&(this._state&F.TOUCH_DOLLY_SCREEN_PAN)!==F.TOUCH_DOLLY_SCREEN_PAN&&(this._state&F.TOUCH_DOLLY_OFFSET)!==F.TOUCH_DOLLY_OFFSET&&(this._state&F.TOUCH_DOLLY_ROTATE)!==F.TOUCH_DOLLY_ROTATE||(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),(this._state&F.ZOOM)!==F.ZOOM&&(this._state&F.TOUCH_ZOOM)!==F.TOUCH_ZOOM&&(this._state&F.TOUCH_ZOOM_TRUCK)!==F.TOUCH_ZOOM_TRUCK&&(this._state&F.TOUCH_ZOOM_SCREEN_PAN)!==F.TOUCH_ZOOM_SCREEN_PAN&&(this._state&F.TOUCH_ZOOM_OFFSET)!==F.TOUCH_ZOOM_OFFSET&&(this._state&F.TOUCH_ZOOM_ROTATE)!==F.TOUCH_ZOOM_ROTATE||(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),(this._state&F.OFFSET)!==F.OFFSET&&(this._state&F.TOUCH_OFFSET)!==F.TOUCH_OFFSET&&(this._state&F.TOUCH_DOLLY_OFFSET)!==F.TOUCH_DOLLY_OFFSET&&(this._state&F.TOUCH_ZOOM_OFFSET)!==F.TOUCH_ZOOM_OFFSET||(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})},m=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,et(this._activePointers,_t);const t=this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,e=t?-t.deltaX:o.x-_t.x,s=t?-t.deltaY:o.y-_t.y;if(o.copy(_t),(this._state&F.ROTATE)!==F.ROTATE&&(this._state&F.TOUCH_ROTATE)!==F.TOUCH_ROTATE&&(this._state&F.TOUCH_DOLLY_ROTATE)!==F.TOUCH_DOLLY_ROTATE&&(this._state&F.TOUCH_ZOOM_ROTATE)!==F.TOUCH_ZOOM_ROTATE||(this._rotateInternal(e,s),this._isUserControllingRotate=!0),(this._state&F.DOLLY)===F.DOLLY||(this._state&F.ZOOM)===F.ZOOM){const t=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,e=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,o=this.dollyDragInverted?-1:1;(this._state&F.DOLLY)===F.DOLLY?(this._dollyInternal(o*s*rt,t,e),this._isUserControllingDolly=!0):(this._zoomInternal(o*s*rt,t,e),this._isUserControllingZoom=!0)}if((this._state&F.TOUCH_DOLLY)===F.TOUCH_DOLLY||(this._state&F.TOUCH_ZOOM)===F.TOUCH_ZOOM||(this._state&F.TOUCH_DOLLY_TRUCK)===F.TOUCH_DOLLY_TRUCK||(this._state&F.TOUCH_ZOOM_TRUCK)===F.TOUCH_ZOOM_TRUCK||(this._state&F.TOUCH_DOLLY_SCREEN_PAN)===F.TOUCH_DOLLY_SCREEN_PAN||(this._state&F.TOUCH_ZOOM_SCREEN_PAN)===F.TOUCH_ZOOM_SCREEN_PAN||(this._state&F.TOUCH_DOLLY_OFFSET)===F.TOUCH_DOLLY_OFFSET||(this._state&F.TOUCH_ZOOM_OFFSET)===F.TOUCH_ZOOM_OFFSET||(this._state&F.TOUCH_DOLLY_ROTATE)===F.TOUCH_DOLLY_ROTATE||(this._state&F.TOUCH_ZOOM_ROTATE)===F.TOUCH_ZOOM_ROTATE){const t=_t.x-this._activePointers[1].clientX,e=_t.y-this._activePointers[1].clientY,s=Math.sqrt(t*t+e*e),i=r.y-s;r.set(0,s);const n=this.dollyToCursor?(o.x-this._elementRect.x)/this._elementRect.width*2-1:0,a=this.dollyToCursor?(o.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&F.TOUCH_DOLLY)===F.TOUCH_DOLLY||(this._state&F.TOUCH_DOLLY_ROTATE)===F.TOUCH_DOLLY_ROTATE||(this._state&F.TOUCH_DOLLY_TRUCK)===F.TOUCH_DOLLY_TRUCK||(this._state&F.TOUCH_DOLLY_SCREEN_PAN)===F.TOUCH_DOLLY_SCREEN_PAN||(this._state&F.TOUCH_DOLLY_OFFSET)===F.TOUCH_DOLLY_OFFSET?(this._dollyInternal(i*rt,n,a),this._isUserControllingDolly=!0):(this._zoomInternal(i*rt,n,a),this._isUserControllingZoom=!0)}(this._state&F.TRUCK)!==F.TRUCK&&(this._state&F.TOUCH_TRUCK)!==F.TOUCH_TRUCK&&(this._state&F.TOUCH_DOLLY_TRUCK)!==F.TOUCH_DOLLY_TRUCK&&(this._state&F.TOUCH_ZOOM_TRUCK)!==F.TOUCH_ZOOM_TRUCK||(this._truckInternal(e,s,!1,!1),this._isUserControllingTruck=!0),(this._state&F.SCREEN_PAN)!==F.SCREEN_PAN&&(this._state&F.TOUCH_SCREEN_PAN)!==F.TOUCH_SCREEN_PAN&&(this._state&F.TOUCH_DOLLY_SCREEN_PAN)!==F.TOUCH_DOLLY_SCREEN_PAN&&(this._state&F.TOUCH_ZOOM_SCREEN_PAN)!==F.TOUCH_ZOOM_SCREEN_PAN||(this._truckInternal(e,s,!1,!0),this._isUserControllingTruck=!0),(this._state&F.OFFSET)!==F.OFFSET&&(this._state&F.TOUCH_OFFSET)!==F.TOUCH_OFFSET&&(this._state&F.TOUCH_DOLLY_OFFSET)!==F.TOUCH_DOLLY_OFFSET&&(this._state&F.TOUCH_ZOOM_OFFSET)!==F.TOUCH_ZOOM_OFFSET||(this._truckInternal(e,s,!0,!1),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},p=()=>{et(this._activePointers,_t),o.copy(_t),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{this._enabled&&this._domElement&&(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",u),this._domElement.ownerDocument.addEventListener("pointerlockerror",E),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",h),d())},this.unlockPointer=()=>{var t,e,s;null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),null===(t=this._domElement)||void 0===t||t.ownerDocument.exitPointerLock(),null===(e=this._domElement)||void 0===e||e.ownerDocument.removeEventListener("pointerlockchange",u),null===(s=this._domElement)||void 0===s||s.ownerDocument.removeEventListener("pointerlockerror",E),this.cancel()};const u=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},E=()=>{this.unlockPointer()};this._addAllEventListeners=t=>{this._domElement=t,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",n),this._domElement.addEventListener("pointercancel",h),this._domElement.addEventListener("wheel",c,{passive:!1}),this._domElement.addEventListener("contextmenu",_)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",n),this._domElement.removeEventListener("pointercancel",h),this._domElement.removeEventListener("wheel",c,{passive:!1}),this._domElement.removeEventListener("contextmenu",_),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",h),this._domElement.ownerDocument.removeEventListener("pointerlockchange",u),this._domElement.ownerDocument.removeEventListener("pointerlockerror",E))},this.cancel=()=>{this._state!==F.NONE&&(this._state=F.NONE,this._activePointers.length=0,p())},s&&this.connect(s),this.update(0)}get camera(){return this._camera}set camera(t){this._camera=t,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(t){this._enabled=t,this._domElement&&(t?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(t){this._spherical.radius===t&&this._sphericalEnd.radius===t||(this._spherical.radius=t,this._sphericalEnd.radius=t,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(t){this._spherical.theta===t&&this._sphericalEnd.theta===t||(this._spherical.theta=t,this._sphericalEnd.theta=t,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(t){this._spherical.phi===t&&this._sphericalEnd.phi===t||(this._spherical.phi=t,this._sphericalEnd.phi=t,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(t){this._boundaryEnclosesCamera=t,this._needsUpdate=!0}set interactiveArea(t){this._interactiveArea.width=X(t.width,0,1),this._interactiveArea.height=X(t.height,0,1),this._interactiveArea.x=X(t.x,0,1-this._interactiveArea.width),this._interactiveArea.y=X(t.y,0,1-this._interactiveArea.height)}addEventListener(t,e){super.addEventListener(t,e)}removeEventListener(t,e){super.removeEventListener(t,e)}rotate(t,e,s=!1){return this.rotateTo(this._sphericalEnd.theta+t,this._sphericalEnd.phi+e,s)}rotateAzimuthTo(t,e=!1){return this.rotateTo(t,this._sphericalEnd.phi,e)}rotatePolarTo(t,e=!1){return this.rotateTo(this._sphericalEnd.theta,t,e)}rotateTo(t,e,s=!1){this._isUserControllingRotate=!1;const i=X(t,this.minAzimuthAngle,this.maxAzimuthAngle),o=X(e,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=i,this._sphericalEnd.phi=o,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,s||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const r=!s||Q(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Q(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(r)}dolly(t,e=!1){return this.dollyTo(this._sphericalEnd.radius-t,e)}dollyTo(t,e=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=H,this._changedDolly=0,this._dollyToNoClamp(X(t,this.minDistance,this.maxDistance),e)}_dollyToNoClamp(t,e=!1){const s=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const e=this._collisionTest(),i=Q(e,this._spherical.radius);if(!(s>t)&&i)return Promise.resolve();this._sphericalEnd.radius=Math.min(t,e)}else this._sphericalEnd.radius=t;this._needsUpdate=!0,e||(this._spherical.radius=this._sphericalEnd.radius);const i=!e||Q(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(i)}dollyInFixed(t,e=!1){this._targetEnd.add(this._getCameraDirection(ut).multiplyScalar(t)),e||this._target.copy(this._targetEnd);const s=!e||Q(this._target.x,this._targetEnd.x,this.restThreshold)&&Q(this._target.y,this._targetEnd.y,this.restThreshold)&&Q(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(s)}zoom(t,e=!1){return this.zoomTo(this._zoomEnd+t,e)}zoomTo(t,e=!1){this._isUserControllingZoom=!1,this._zoomEnd=X(t,this.minZoom,this.maxZoom),this._needsUpdate=!0,e||(this._zoom=this._zoomEnd);const s=!e||Q(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(s)}pan(t,e,s=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(t,e,s)}truck(t,e,s=!1){this._camera.updateMatrix(),Et.setFromMatrixColumn(this._camera.matrix,0),gt.setFromMatrixColumn(this._camera.matrix,1),Et.multiplyScalar(t),gt.multiplyScalar(-e);const i=dt.copy(Et).add(gt),o=mt.copy(this._targetEnd).add(i);return this.moveTo(o.x,o.y,o.z,s)}forward(t,e=!1){dt.setFromMatrixColumn(this._camera.matrix,0),dt.crossVectors(this._camera.up,dt),dt.multiplyScalar(t);const s=mt.copy(this._targetEnd).add(dt);return this.moveTo(s.x,s.y,s.z,e)}elevate(t,e=!1){return dt.copy(this._camera.up).multiplyScalar(t),this.moveTo(this._targetEnd.x+dt.x,this._targetEnd.y+dt.y,this._targetEnd.z+dt.z,e)}moveTo(t,e,s,i=!1){this._isUserControllingTruck=!1;const o=dt.set(t,e,s).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,o,this.boundaryFriction),this._needsUpdate=!0,i||this._target.copy(this._targetEnd);const r=!i||Q(this._target.x,this._targetEnd.x,this.restThreshold)&&Q(this._target.y,this._targetEnd.y,this.restThreshold)&&Q(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}lookInDirectionOf(t,e,s,i=!1){const o=dt.set(t,e,s).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius).add(this._targetEnd);return this.setPosition(o.x,o.y,o.z,i)}fitToBox(t,e,{cover:s=!1,paddingLeft:i=0,paddingRight:o=0,paddingBottom:r=0,paddingTop:n=0}={}){const a=[],h=t.isBox3?vt.copy(t):vt.setFromObject(t);h.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const l=q(this._sphericalEnd.theta,B),c=q(this._sphericalEnd.phi,B);a.push(this.rotateTo(l,c,e));const _=dt.setFromSpherical(this._sphericalEnd).normalize(),d=St.setFromUnitVectors(_,ct),m=Q(Math.abs(_.y),1);m&&d.multiply(At.setFromAxisAngle(lt,l)),d.multiply(this._yAxisUpSpaceInverse);const p=xt.makeEmpty();mt.copy(h.min).applyQuaternion(d),p.expandByPoint(mt),mt.copy(h.min).setX(h.max.x).applyQuaternion(d),p.expandByPoint(mt),mt.copy(h.min).setY(h.max.y).applyQuaternion(d),p.expandByPoint(mt),mt.copy(h.max).setZ(h.min.z).applyQuaternion(d),p.expandByPoint(mt),mt.copy(h.min).setZ(h.max.z).applyQuaternion(d),p.expandByPoint(mt),mt.copy(h.max).setY(h.min.y).applyQuaternion(d),p.expandByPoint(mt),mt.copy(h.max).setX(h.min.x).applyQuaternion(d),p.expandByPoint(mt),mt.copy(h.max).applyQuaternion(d),p.expandByPoint(mt),p.min.x-=i,p.min.y-=r,p.max.x+=o,p.max.y+=n,d.setFromUnitVectors(ct,_),m&&d.premultiply(At.invert()),d.premultiply(this._yAxisUpSpace);const u=p.getSize(dt),E=p.getCenter(mt).applyQuaternion(d);if(Y(this._camera)){const t=this.getDistanceToFitBox(u.x,u.y,u.z,s);a.push(this.moveTo(E.x,E.y,E.z,e)),a.push(this.dollyTo(t,e)),a.push(this.setFocalOffset(0,0,0,e))}else if(j(this._camera)){const t=this._camera,i=t.right-t.left,o=t.top-t.bottom,r=s?Math.max(i/u.x,o/u.y):Math.min(i/u.x,o/u.y);a.push(this.moveTo(E.x,E.y,E.z,e)),a.push(this.zoomTo(r,e)),a.push(this.setFocalOffset(0,0,0,e))}return Promise.all(a)}fitToSphere(e,s){const i=[],o="isObject3D"in e?t.createBoundingSphere(e,Ut):Ut.copy(e);if(i.push(this.moveTo(o.center.x,o.center.y,o.center.z,s)),Y(this._camera)){const t=this.getDistanceToFitSphere(o.radius);i.push(this.dollyTo(t,s))}else if(j(this._camera)){const t=this._camera.right-this._camera.left,e=this._camera.top-this._camera.bottom,r=2*o.radius,n=Math.min(t/r,e/r);i.push(this.zoomTo(n,s))}return i.push(this.setFocalOffset(0,0,0,s)),Promise.all(i)}setLookAt(t,e,s,i,o,r,n=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=H,this._changedDolly=0;const a=mt.set(i,o,r),h=dt.set(t,e,s);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(h.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,n||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const l=!n||Q(this._target.x,this._targetEnd.x,this.restThreshold)&&Q(this._target.y,this._targetEnd.y,this.restThreshold)&&Q(this._target.z,this._targetEnd.z,this.restThreshold)&&Q(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Q(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Q(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(l)}lerpLookAt(t,e,s,i,o,r,n,a,h,l,c,_,d,m=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=H,this._changedDolly=0;const p=dt.set(i,o,r),u=mt.set(t,e,s);ft.setFromVector3(u.sub(p).applyQuaternion(this._yAxisUpSpace));const E=pt.set(l,c,_),g=mt.set(n,a,h);Ct.setFromVector3(g.sub(E).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(E,d));const O=Ct.theta-ft.theta,y=Ct.phi-ft.phi,T=Ct.radius-ft.radius;this._sphericalEnd.set(ft.radius+T*d,ft.phi+y*d,ft.theta+O*d),this.normalizeRotations(),this._needsUpdate=!0,m||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const f=!m||Q(this._target.x,this._targetEnd.x,this.restThreshold)&&Q(this._target.y,this._targetEnd.y,this.restThreshold)&&Q(this._target.z,this._targetEnd.z,this.restThreshold)&&Q(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&Q(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&Q(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(f)}setPosition(t,e,s,i=!1){return this.setLookAt(t,e,s,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,i)}setTarget(t,e,s,i=!1){const o=this.getPosition(dt),r=this.setLookAt(o.x,o.y,o.z,t,e,s,i);return this._sphericalEnd.phi=X(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),r}setFocalOffset(t,e,s,i=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(t,e,s),this._needsUpdate=!0,i||this._focalOffset.copy(this._focalOffsetEnd);const o=!i||Q(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&Q(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&Q(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(o)}setOrbitPoint(t,e,s){this._camera.updateMatrixWorld(),Et.setFromMatrixColumn(this._camera.matrixWorldInverse,0),gt.setFromMatrixColumn(this._camera.matrixWorldInverse,1),Ot.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const i=dt.set(t,e,s),o=i.distanceTo(this._camera.position),r=i.sub(this._camera.position);Et.multiplyScalar(r.x),gt.multiplyScalar(r.y),Ot.multiplyScalar(r.z),dt.copy(Et).add(gt).add(Ot),dt.z=dt.z+o,this.dollyTo(o,!1),this.setFocalOffset(-dt.x,dt.y,-dt.z,!1),this.moveTo(t,e,s,!1)}setBoundary(t){if(!t)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(t),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(t,e,s,i){null!==t?(this._viewport=this._viewport||new at.Vector4,"number"==typeof t?this._viewport.set(t,e,s,i):this._viewport.copy(t)):this._viewport=null}getDistanceToFitBox(t,e,s,i=!1){if(st(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const o=t/e,r=this._camera.getEffectiveFOV()*K,n=this._camera.aspect;return.5*((i?o>n:o<n)?e:t/n)/Math.tan(.5*r)+.5*s}getDistanceToFitSphere(t){if(st(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const e=this._camera.getEffectiveFOV()*K,s=2*Math.atan(Math.tan(.5*e)*this._camera.aspect),i=1<this._camera.aspect?e:s;return t/Math.sin(.5*i)}getTarget(t,e=!0){return(t&&t.isVector3?t:new at.Vector3).copy(e?this._targetEnd:this._target)}getPosition(t,e=!0){return(t&&t.isVector3?t:new at.Vector3).setFromSpherical(e?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(e?this._targetEnd:this._target)}getSpherical(t,e=!0){return(t||new at.Spherical).copy(e?this._sphericalEnd:this._spherical)}getFocalOffset(t,e=!0){return(t&&t.isVector3?t:new at.Vector3).copy(e?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%Z,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=Z),this._spherical.theta+=Z*Math.round((this._sphericalEnd.theta-this._spherical.theta)/Z)}stop(){this._focalOffset.copy(this._focalOffsetEnd),this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd),this._zoom=this._zoomEnd}reset(t=!1){if(!Q(this._camera.up.x,this._cameraUp0.x)||!Q(this._camera.up.y,this._cameraUp0.y)||!Q(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const t=this.getPosition(dt);this.updateCameraUp(),this.setPosition(t.x,t.y,t.z)}const e=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,t),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,t),this.zoomTo(this._zoom0,t)];return Promise.all(e)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,lt),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const t=dt.subVectors(this._target,this._camera.position).normalize(),e=mt.crossVectors(t,this._camera.up);this._camera.up.crossVectors(e,t).normalize(),this._camera.updateMatrixWorld();const s=this.getPosition(dt);this.updateCameraUp(),this.setPosition(s.x,s.y,s.z)}update(t){const e=this._sphericalEnd.theta-this._spherical.theta,s=this._sphericalEnd.phi-this._spherical.phi,i=this._sphericalEnd.radius-this._spherical.radius,o=yt.subVectors(this._targetEnd,this._target),r=Tt.subVectors(this._focalOffsetEnd,this._focalOffset),n=this._zoomEnd-this._zoom;if(W(e))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const e=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=$(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,e,1/0,t),this._needsUpdate=!0}if(W(s))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const e=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=$(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,e,1/0,t),this._needsUpdate=!0}if(W(i))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const e=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=$(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,e,this.maxSpeed,t),this._needsUpdate=!0}if(W(o.x)&&W(o.y)&&W(o.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const e=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;tt(this._target,this._targetEnd,this._targetVelocity,e,this.maxSpeed,t,this._target),this._needsUpdate=!0}if(W(r.x)&&W(r.y)&&W(r.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const e=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;tt(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,e,this.maxSpeed,t,this._focalOffset),this._needsUpdate=!0}if(W(n))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const e=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=$(this._zoom,this._zoomEnd,this._zoomVelocity,e,1/0,t)}if(this.dollyToCursor)if(Y(this._camera)&&0!==this._changedDolly){const t=this._spherical.radius-this._lastDistance,e=this._camera,s=this._getCameraDirection(ut),i=dt.copy(s).cross(e.up).normalize();0===i.lengthSq()&&(i.x=1);const o=mt.crossVectors(i,s),r=this._sphericalEnd.radius*Math.tan(e.getEffectiveFOV()*K*.5),n=(this._sphericalEnd.radius-t-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=pt.copy(this._targetEnd).add(i.multiplyScalar(this._dollyControlCoord.x*r*e.aspect)).add(o.multiplyScalar(this._dollyControlCoord.y*r)),h=dt.copy(this._targetEnd).lerp(a,n),l=this._lastDollyDirection===N&&this._spherical.radius<=this.minDistance,c=this._lastDollyDirection===V&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(l||c)){this._sphericalEnd.radius-=t,this._spherical.radius-=t;const e=mt.copy(s).multiplyScalar(-t);h.add(e)}this._boundary.clampPoint(h,h);const _=mt.subVectors(h,this._targetEnd);this._targetEnd.copy(h),this._target.add(_),this._changedDolly-=t,W(this._changedDolly)&&(this._changedDolly=0)}else if(j(this._camera)&&0!==this._changedZoom){const t=this._zoom-this._lastZoom,e=this._camera,s=dt.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(e.near+e.far)/(e.near-e.far)).unproject(e),i=mt.set(0,0,-1).applyQuaternion(e.quaternion),o=pt.copy(s).add(i.multiplyScalar(-s.dot(e.up))),r=-(this._zoom-t-this._zoom)/this._zoom,n=this._getCameraDirection(ut),a=this._targetEnd.dot(n),h=dt.copy(this._targetEnd).lerp(o,r),l=h.dot(n),c=n.multiplyScalar(l-a);h.sub(c),this._boundary.clampPoint(h,h);const _=mt.subVectors(h,this._targetEnd);this._targetEnd.copy(h),this._target.add(_),this._changedZoom-=t,W(this._changedZoom)&&(this._changedZoom=0)}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target);(!W(this._focalOffset.x)||!W(this._focalOffset.y)||!W(this._focalOffset.z))&&(Et.setFromMatrixColumn(this._camera.matrix,0),gt.setFromMatrixColumn(this._camera.matrix,1),Ot.setFromMatrixColumn(this._camera.matrix,2),Et.multiplyScalar(this._focalOffset.x),gt.multiplyScalar(-this._focalOffset.y),Ot.multiplyScalar(this._focalOffset.z),dt.copy(Et).add(gt).add(Ot),this._camera.position.add(dt),this._camera.updateMatrixWorld()),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),dt.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const h=this._needsUpdate;return h&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):h?(this.dispatchEvent({type:"update"}),W(e,this.restThreshold)&&W(s,this.restThreshold)&&W(i,this.restThreshold)&&W(o.x,this.restThreshold)&&W(o.y,this.restThreshold)&&W(o.z,this.restThreshold)&&W(r.x,this.restThreshold)&&W(r.y,this.restThreshold)&&W(r.z,this.restThreshold)&&W(n,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!h&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=h,this._needsUpdate=!1,h}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:G(this.maxDistance),minZoom:this.minZoom,maxZoom:G(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:G(this.maxPolarAngle),minAzimuthAngle:G(this.minAzimuthAngle),maxAzimuthAngle:G(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,target:this._targetEnd.toArray(),position:dt.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(t,e=!1){const s=JSON.parse(t);this.enabled=s.enabled,this.minDistance=s.minDistance,this.maxDistance=J(s.maxDistance),this.minZoom=s.minZoom,this.maxZoom=J(s.maxZoom),this.minPolarAngle=s.minPolarAngle,this.maxPolarAngle=J(s.maxPolarAngle),this.minAzimuthAngle=J(s.minAzimuthAngle),this.maxAzimuthAngle=J(s.maxAzimuthAngle),this.smoothTime=s.smoothTime,this.draggingSmoothTime=s.draggingSmoothTime,this.dollySpeed=s.dollySpeed,this.truckSpeed=s.truckSpeed,this.dollyToCursor=s.dollyToCursor,this._target0.fromArray(s.target0),this._position0.fromArray(s.position0),this._zoom0=s.zoom0,this._focalOffset0.fromArray(s.focalOffset0),this.moveTo(s.target[0],s.target[1],s.target[2],e),ft.setFromVector3(dt.fromArray(s.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(ft.theta,ft.phi,e),this.dollyTo(ft.radius,e),this.zoomTo(s.zoom,e),this.setFocalOffset(s.focalOffset[0],s.focalOffset[1],s.focalOffset[2],e),this._needsUpdate=!0}connect(t){this._domElement?console.warn("camera-controls is already connected."):(t.setAttribute("data-camera-controls-version","2.10.1"),this._addAllEventListeners(t),this._getClientRect(this._elementRect))}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(t){return t.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(t){return this._getTargetDirection(t).negate()}_findPointerById(t){return this._activePointers.find((e=>e.pointerId===t))}_findPointerByMouseButton(t){return this._activePointers.find((e=>e.mouseButton===t))}_disposePointer(t){this._activePointers.splice(this._activePointers.indexOf(t),1)}_encloseToBoundary(t,e,s){const i=e.lengthSq();if(0===i)return t;const o=mt.copy(e).add(t),r=this._boundary.clampPoint(o,pt).sub(o),n=r.lengthSq();if(0===n)return t.add(e);if(n===i)return t;if(0===s)return t.add(e).add(r);{const i=1+s*n/e.dot(r);return t.add(mt.copy(e).multiplyScalar(i)).add(r.multiplyScalar(1-s))}}_updateNearPlaneCorners(){if(Y(this._camera)){const t=this._camera,e=t.near,s=t.getEffectiveFOV()*K,i=Math.tan(.5*s)*e,o=i*t.aspect;this._nearPlaneCorners[0].set(-o,-i,0),this._nearPlaneCorners[1].set(o,-i,0),this._nearPlaneCorners[2].set(o,i,0),this._nearPlaneCorners[3].set(-o,i,0)}else if(j(this._camera)){const t=this._camera,e=1/t.zoom,s=t.left*e,i=t.right*e,o=t.top*e,r=t.bottom*e;this._nearPlaneCorners[0].set(s,o,0),this._nearPlaneCorners[1].set(i,o,0),this._nearPlaneCorners[2].set(i,r,0),this._nearPlaneCorners[3].set(s,r,0)}}_collisionTest(){let t=1/0;if(!(this.colliderMeshes.length>=1))return t;if(st(this._camera,"_collisionTest"))return t;const e=this._getTargetDirection(ut);wt.lookAt(ht,e,this._camera.up);for(let s=0;s<4;s++){const i=mt.copy(this._nearPlaneCorners[s]);i.applyMatrix4(wt);const o=pt.addVectors(this._target,i);Lt.set(o,e),Lt.far=this._spherical.radius+1;const r=Lt.intersectObjects(this.colliderMeshes);0!==r.length&&r[0].distance<t&&(t=r[0].distance)}return t}_getClientRect(t){if(!this._domElement)return;const e=this._domElement.getBoundingClientRect();return t.x=e.left,t.y=e.top,this._viewport?(t.x+=this._viewport.x,t.y+=e.height-this._viewport.w-this._viewport.y,t.width=this._viewport.z,t.height=this._viewport.w):(t.width=e.width,t.height=e.height),t}_createOnRestPromise(t){return t?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise((t=>{const e=()=>{this.removeEventListener("rest",e),t()};this.addEventListener("rest",e)})))}_addAllEventListeners(t){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(t){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(t){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(t,e=new at.Sphere){const s=e,i=s.center;vt.makeEmpty(),t.traverseVisible((t=>{t.isMesh&&vt.expandByObject(t)})),vt.getCenter(i);let o=0;return t.traverseVisible((t=>{if(!t.isMesh)return;const e=t;if(!e.geometry)return;const s=e.geometry.clone();s.applyMatrix4(e.matrixWorld);const r=s.attributes.position;for(let n=0,a=r.count;n<a;n++)dt.fromBufferAttribute(r,n),o=Math.max(o,i.distanceToSquared(dt))})),s.radius=Math.sqrt(o),s}};const Pt=r.forwardRef(((t,o)=>{r.useMemo((()=>{const t={Box3:d,MathUtils:{clamp:m.clamp},Matrix4:p,Quaternion:u,Raycaster:E,Sphere:g,Spherical:O,Vector2:y,Vector3:T,Vector4:f};Dt.install({THREE:t}),h({CameraControlsImpl:Dt})}),[]);const n=t,{camera:a,domElement:C,makeDefault:v,onControlStart:x,onControl:U,onControlEnd:S,onTransitionStart:A,onUpdate:w,onWake:L,onRest:D,onSleep:P,onStart:R,onEnd:k,onChange:b,regress:M}=n,z=((t,o)=>{var r={};for(var n in t)s.call(t,n)&&o.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&e)for(var n of e(t))o.indexOf(n)<0&&i.call(t,n)&&(r[n]=t[n]);return r})(n,["camera","domElement","makeDefault","onControlStart","onControl","onControlEnd","onTransitionStart","onUpdate","onWake","onRest","onSleep","onStart","onEnd","onChange","regress"]),F=l((t=>t.camera)),H=l((t=>t.gl)),N=l((t=>t.invalidate)),V=l((t=>t.events)),Y=l((t=>t.setEvents)),j=l((t=>t.set)),Z=l((t=>t.get)),B=l((t=>t.performance)),I=a||F,K=C||V.connected||H.domElement,X=r.useMemo((()=>new Dt(I)),[I]);return c(((t,e)=>{X.update(e)}),-1),r.useEffect((()=>(X.connect(K),()=>{X.disconnect()})),[K,X]),r.useEffect((()=>{function t(){N(),M&&B.regress()}const e=e=>{t(),null==x||x(e),null==R||R(e)},s=e=>{t(),null==U||U(e),null==b||b(e)},i=t=>{null==S||S(t),null==k||k(t)},o=e=>{t(),null==A||A(e),null==b||b(e)},r=e=>{t(),null==w||w(e),null==b||b(e)},n=e=>{t(),null==L||L(e),null==b||b(e)},a=t=>{null==D||D(t)},h=t=>{null==P||P(t)};return X.addEventListener("controlstart",e),X.addEventListener("control",s),X.addEventListener("controlend",i),X.addEventListener("transitionstart",o),X.addEventListener("update",r),X.addEventListener("wake",n),X.addEventListener("rest",a),X.addEventListener("sleep",h),()=>{X.removeEventListener("controlstart",e),X.removeEventListener("control",s),X.removeEventListener("controlend",i),X.removeEventListener("transitionstart",o),X.removeEventListener("update",r),X.removeEventListener("wake",n),X.removeEventListener("rest",a),X.removeEventListener("sleep",h)}}),[X,N,Y,M,B,x,U,S,A,w,L,D,P,b,R,k]),r.useEffect((()=>{if(v){const t=Z().controls;return j({controls:X}),()=>j({controls:t})}}),[v,X]),r.createElement("primitive",_({ref:o,object:X},z))}));function Rt({all:t,scene:e,camera:s}){const i=l((({gl:t})=>t)),o=l((({camera:t})=>t)),n=l((({scene:t})=>t));return r.useLayoutEffect((()=>{const r=[];t&&(e||n).traverse((t=>{!1===t.visible&&(r.push(t),t.visible=!0)})),i.compile(e||n,s||o);const a=new C(128);new v(.01,1e5,a).update(i,e||n),a.dispose(),r.forEach((t=>t.visible=!1))}),[]),null}class kt{}o(kt,"METALS",["#333","#6F6E6A","#34495E","#DEB887","#eee","#E84118","#068BD3","#A6E22E","#F1C40F","#8E44AD","#BA3763","#F1396E"]),o(kt,"DECKS",["/assets/OniMask-7WTs7MJq.png","/assets/PinkSwirl-PEBQ9Bhz.png","/assets/red-and-black-3eqJr6MO.png","/assets/against-the-tide-i4_urUwp.png","/assets/thank-you-deck-A_2Zc2jS.png","/assets/yellow-and-black-RBVnQlns.png","/assets/red-and-white-2ImHtUZ5.png","/assets/black-and-yellow-pEywBLPD.png","/assets/green-and-navy-jl2qbhXc.png","/assets/gray-and-black-qlEyLFo1.png","/assets/grid-streaks-HtRiMl3E.png"]),o(kt,"WHEELS",["/assets/wheel-black-aUDxje9X.png","/assets/wheel-blue-6s_4nj1X.png","/assets/wheel-cream-V1bDduC2.png","/assets/wheel-green-cIFku8PE.png","/assets/wheel-navy-F1gJPLkU.png","/assets/wheel-pink-35KoXwCV.png","/assets/wheel-purple-VAbJedA0.png","/assets/wheel-red-Mz_DSfC8.png","/assets/wheel-yellow-INPpXFuU.png"]);const bt=[0,.3,0],Mt=[2.5,.75,0],zt=r.createContext({wheel:kt.WHEELS[0],updateWheels:()=>{},deck:kt.DECKS[0],updateDeck:()=>{},truck:kt.METALS[0],updateTrucks:()=>{},bolt:kt.METALS[0],updateBolts:()=>{},lookAtDeck:()=>{},camera:r.createRef()}),Ft=({children:t})=>{const[e,s]=r.useState(kt.WHEELS[0]),[i,o]=r.useState(kt.METALS[0]),[a,h]=r.useState(kt.DECKS[0]),[l,c]=r.useState(kt.METALS[0]),{camera:_,lookAtBolts:d,lookAtTruck:m,lookAtWheel:p,lookAtDeck:u}=(()=>{const t=r.useRef(null),e=r.useCallback(((e,s)=>{t.current&&(t.current.setTarget(e.x,e.y,e.z,!0),t.current.setPosition(s.x,s.y,s.z,!0))}),[t]),s=r.useCallback((()=>{e(new T(0,.29,.5),new T(.4,.3,1))}),[e]),i=r.useCallback((()=>{e(new T(.2,.54,.65),new T(.4,1,.6))}),[e]),o=r.useCallback((()=>{e(new T(.15,.3,.62),new T(-.75,.35,.8))}),[e]),n=r.useCallback((()=>{e(new T(...bt),new T(...Mt))}),[e]);return r.useMemo((()=>({camera:t,lookAtBolts:o,lookAtDeck:n,lookAtTruck:s,lookAtWheel:i})),[o,n,s,i])})(),E=r.useCallback(((t,e)=>s=>{t(s),e()}),[]),g=r.useMemo((()=>E(s,p)),[E,p]),O=r.useMemo((()=>E(c,m)),[E,m]),y=r.useMemo((()=>E(h,u)),[E,u]),f=r.useMemo((()=>E(o,d)),[E,d]),C=r.useMemo((()=>({camera:_,wheel:e,bolt:i,deck:a,truck:l,lookAtDeck:u,updateWheels:g,updateTrucks:O,updateDeck:y,updateBolts:f})),[e,i,a,l,_,u,g,O,y,f]);return n.jsx(zt.Provider,{value:C,children:t})},Ht=()=>r.useContext(zt),Nt=({selected:t,children:e,onClick:s,colorField:i,imageField:o,imageStyles:h})=>{const l=a("option",{selected:t}),c=r.useCallback((()=>{var t;s(null!=(t=null!=i?i:o)?t:"")}),[s,i,o]);return n.jsx("li",{children:n.jsxs("button",{className:l,onClick:c,children:[o?n.jsx("img",{src:o,alt:"",style:h}):n.jsx("div",{style:{backgroundColor:null!=i?i:void 0}}),n.jsx("span",{children:e})]})})},Vt=({title:t,selectedName:e,children:s})=>{const i=r.useMemo((()=>e?function(t){const e=t.split("/"),s=e[e.length-1],[i]=s.split(".");return i.replace(/-/g," ")}(e):""),[e]);return n.jsxs("div",{className:"options",children:[n.jsxs("div",{children:[n.jsx("h2",{children:t}),n.jsxs("p",{children:[n.jsx("span",{children:"| "}),i]})]}),n.jsx("ul",{children:s})]})};const Yt=t=>{const{deck:e,bolt:s,wheel:i,truck:o,updateBolts:r,updateDeck:a,updateTrucks:h,updateWheels:l}=Ht();return n.jsxs("div",{className:"controls",children:[n.jsx(Vt,{title:"Deck",selectedName:e,children:kt.DECKS.map((t=>n.jsx(Nt,{imageField:t,onClick:a,imageStyles:{width:"500%",height:"500%",translate:"20% -0%",objectFit:"cover"},selected:t===e,children:t.replace(/-/g," ")},t)))}),n.jsx(Vt,{title:"Wheels",selectedName:i,children:kt.WHEELS.map((t=>n.jsx(Nt,{imageField:t,onClick:l,imageStyles:{width:"125%",height:"125%",translate:"6% 8%",objectFit:"cover"},selected:t===i,children:t.replace(/-/g," ")},t)))}),n.jsx(Vt,{title:"Trucks",selectedName:o,children:kt.METALS.map((t=>n.jsx(Nt,{colorField:t,onClick:h,selected:t===o,children:t.replace(/-/g," ")},t)))}),n.jsx(Vt,{title:"Bolts",selectedName:s,children:kt.METALS.map((t=>n.jsx(Nt,{colorField:t,onClick:r,selected:t===s,children:t.replace(/-/g," ")},t)))})]})},jt="/assets/warehouse-512-2HjUVqN4.hdr",Zt="#3b3a3a",Bt=t=>{const e=x("/assets/concrete-normal-cZDGbQ2H.avif",(t=>{P.wrap(t).repeat(t,30).rerender(t),t.anisotropy=8})),s=r.useMemo((()=>new U({roughness:.75,color:Zt,normalMap:e})),[e]);return n.jsx("mesh",{castShadow:!0,receiveShadow:!0,position:[0,-.005,0],rotation:[-Math.PI/2,0,0],material:s,children:n.jsx("circleGeometry",{args:[20,32]})})},It="/assets/skateboard-Gug943IH.gltf",Kt=r.forwardRef((function({wheelTexture:t,deckTexture:e,boltColor:s,truckColor:i,pos:o="upright"},a){const{nodes:h}=R(It),l=r.useRef([]),c=(()=>{const t=x("/assets/griptape-diffuse-PcFuFE1u.webp"),e=x("/assets/griptape-roughness-9ocPRl8P.webp");return r.useMemo((()=>{const s=new U({map:t,bumpMap:e,roughnessMap:e,bumpScale:3.5,roughness:.8,color:"#555"});return t&&P.wrap(t).repeat(t,9).rerender(t),e&&(P.wrap(e).repeat(e,9).rerender(e),e.anisotropy=8),s}),[t,e])})(),_=((t="#555")=>r.useMemo((()=>new U({color:t,metalness:.5,roughness:.3})),[t]))(s),d=((t="#555")=>{const e=x("/assets/metal-normal-61eyqixG.avif",(t=>{P.wrap(t).repeat(t,8).rerender(t),t.anisotropy=8}));return r.useMemo((()=>new U({color:t,metalness:.8,roughness:.25,normalMap:e,normalScale:new y(.3,.3)})),[t,e])})(i),m=(p=e,r.useMemo((()=>new U({roughness:.1,map:p})),[p]));var p;const u=(t=>r.useMemo((()=>new U({roughness:.35,map:t})),[t]))(t),E=r.useCallback(((t,e)=>s=>{s&&(e.current[t]=s)}),[]),g=r.useMemo((()=>Array.from({length:4},((t,e)=>E(e,l)))),[E]),O=r.useMemo((()=>({side:{rotation:[0,0,Math.PI/2],position:[.25,.295,0]},upright:{rotation:[0,0,0],position:[0,0,0]}})),[]);return r.useImperativeHandle(a,(()=>({wheels:l})),[l]),n.jsx("group",{dispose:null,rotation:O[o].rotation,position:O[o].position,children:n.jsxs("group",{name:"Scene",children:[n.jsx("mesh",{name:"GripTape",castShadow:!0,receiveShadow:!0,material:c,geometry:h.GripTape.geometry,position:[0,.286,-.002]}),n.jsx("mesh",{name:"Wheel1",castShadow:!0,receiveShadow:!0,ref:g[0],geometry:h.Wheel1.geometry,material:u,position:[.238,.086,.635]}),n.jsx("mesh",{name:"Wheel2",castShadow:!0,receiveShadow:!0,ref:g[1],geometry:h.Wheel2.geometry,material:u,position:[-.237,.086,.635]}),n.jsx("mesh",{name:"Deck",castShadow:!0,receiveShadow:!0,geometry:h.Deck.geometry,material:m,position:[0,.271,-.002]}),n.jsx("mesh",{name:"Wheel4",castShadow:!0,receiveShadow:!0,ref:g[3],geometry:h.Wheel4.geometry,material:u,position:[-.238,.086,-.635],rotation:[Math.PI,0,Math.PI]}),n.jsx("mesh",{name:"Bolts",castShadow:!0,receiveShadow:!0,geometry:h.Bolts.geometry,material:_,position:[0,.198,0],rotation:[Math.PI,0,Math.PI]}),n.jsx("mesh",{name:"Wheel3",castShadow:!0,receiveShadow:!0,ref:g[2],geometry:h.Wheel3.geometry,material:u,position:[.237,.086,-.635],rotation:[Math.PI,0,Math.PI]}),n.jsx("mesh",{name:"Baseplates",castShadow:!0,receiveShadow:!0,geometry:h.Baseplates.geometry,material:d,position:[0,.211,0]}),n.jsx("mesh",{name:"Truck1",castShadow:!0,receiveShadow:!0,geometry:h.Truck1.geometry,material:d,position:[0,.101,-.617]}),n.jsx("mesh",{name:"Truck2",castShadow:!0,receiveShadow:!0,geometry:h.Truck2.geometry,material:d,position:[0,.101,.617],rotation:[Math.PI,0,Math.PI]})]})})}));R.preload(It);const Xt=(t,e)=>{const s=(t=>{const e=x(t,(t=>{(Array.isArray(t)?e:[e]).forEach((t=>{t.flipY=!1,t.colorSpace=S,t.needsUpdate=!0}))}));return e})(t),i=r.useMemo((()=>{const e={},{length:s}=t;for(let i=0;i<s;i++)e[t[i]]=i;return e}),[t]),o=r.useMemo((()=>{var t;return null!=(t=i[null!=e?e:"-1"])?t:0}),[i,e]);return r.useMemo((()=>s[o]),[s,o])},Wt="#6f6e6a";function Qt(t){A();const e=r.useRef(null),s=r.useRef(null),{camera:i,wheel:o,deck:a,bolt:h,truck:l,lookAtDeck:c}=Ht(),_=Xt(kt.DECKS,a),d=Xt(kt.WHEELS,o),m=null!=l?l:Wt,p=null!=h?h:Wt,u=r.useCallback((()=>{i.current&&e.current&&!i.current.colliderMeshes.length&&(i.current.colliderMeshes=[e.current])}),[i]);return r.useEffect((()=>{var t,e,i;if(null==(i=null==(e=null==(t=null==s?void 0:s.current)?void 0:t.wheels)?void 0:e.current)?void 0:i.length)for(const o of s.current.wheels.current)o&&D.to(o.rotation,{x:"+=30",duration:2.5,ease:"circ.out"})}),[o]),r.useEffect((()=>{i.current&&c()}),[c,i]),n.jsxs(r.Fragment,{children:[n.jsxs(r.Suspense,{fallback:null,children:[n.jsx(k,{files:jt,environmentIntensity:.6}),n.jsx("directionalLight",{castShadow:!0,lookAt:[0,0,0],position:[1,1,1],intensity:1.6}),n.jsx("fog",{attach:"fog",args:[Zt,3,10]}),n.jsx("color",{attach:"background",args:[Zt]}),n.jsx(Bt,{}),n.jsxs("mesh",{rotation:[-Math.PI/2,0,0],ref:e,children:[n.jsx("planeGeometry",{args:[6,6]}),n.jsx("meshBasicMaterial",{visible:!1})]}),n.jsx(Kt,{pos:"side",ref:s,boltColor:p,truckColor:m,deckTexture:_,wheelTexture:d}),n.jsx(Pt,{makeDefault:!0,ref:i,maxDistance:4,minDistance:.2,onStart:u})]}),n.jsx(Rt,{all:!0})]})}function qt(t){return n.jsx("div",{className:"skateboard-scene",children:n.jsxs(Ft,{children:[n.jsx("div",{className:"preview",children:n.jsx("div",{className:"canvas-container",children:n.jsx(w,{shadows:!0,camera:{fov:50,position:Mt},children:n.jsx(Qt,{})})})}),n.jsxs("div",{className:"options-menu",children:[n.jsx(L,{text:"Build Your Board"}),n.jsx(Yt,{})]})]})})}export{qt as default};
//# sourceMappingURL=index-fenkpZ0p.js.map
