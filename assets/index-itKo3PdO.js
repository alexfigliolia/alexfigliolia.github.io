import{r as e,b as s,j as t,u as r}from"./threeFiber-C7PdTxs4.js";import{L as a}from"./index-_BY9d4cF.js";import{p as o,q as n}from"./index-h_i4lC7b.js";import{h as i,K as c,d as l}from"./three-_vvEHZTK.js";import{K as m,T as u}from"./Textures-iK-qAZTJ.js";import{u as h,a as p,M as d,O as x,P as f,C as j,E as M}from"./threeDrei-jPcrdQkF.js";import"./useLabsLoader-tvnYWh2F.js";import"./threeStdLib-Js3c5gj8.js";const g=({color:r})=>{const a=e.useRef(0),o=e.useRef(null),n=e.useRef(y()),i=e.useMemo((()=>Math.random()),[]),c=e.useMemo((()=>Math.random()),[]),l=e.useMemo((()=>.5*Math.pow(Math.random(),2)+.05),[]);return s(((e,s)=>{if(a.current+=1.2*s,!o.current)return;const{x:t,y:r,z:l}=n.current,m=l-a.current;m<-10&&(n.current=y(10*Math.random()+10),a.current=0),o.current.position.set(t,r,m),o.current.rotation.x+=i*s,o.current.rotation.y+=c*s})),t.jsxs("mesh",{castShadow:!0,ref:o,scale:l,children:[t.jsx("boxGeometry",{args:[1,1,1]}),t.jsx("meshStandardMaterial",{color:r,envMapIntensity:.15})]})};function y(e=15*(2*Math.random()-1)){const s=new i(3*(2*Math.random()-1),Math.max(.5,2.5*Math.random()+.1),e);return s.x<0?s.x-=2.5:s.x>0&&(s.x+=2.5),s}const S=[.4,.1,.1],w=[.05,.15,.4],b=({total:s=100})=>{const r=e.useMemo((()=>new Array(s).fill(null)),[s]);return t.jsx(e.Fragment,{children:r.map(((e,s)=>t.jsx(g,{color:s%2==0?S:w},s)))})},v="/assets/Corvette-L85qAWa-.glb";class E{static forEachMesh(e,s){e.traverse((e=>{this.isMesh(e)&&s(e)}))}static forEachMaterial(e,s){const t=Array.isArray(e)?e:[e];for(const r of t)s(r)}static isMesh(e){return e instanceof c}}const k=["polySurface778","polySurface491","polySurface33","polySurface262"],T=(t,r=110)=>{const a=e.useRef([]);e.useEffect((()=>{t.scale.set(r,r,r),t.position.set(0,0,0)}),[t,r]),e.useEffect((()=>{const e=[];E.forEachMesh(t,(s=>{s.castShadow=!0,s.receiveShadow=!0,E.forEachMaterial(s.material,(e=>{e.envMapIntensity=20})),s.name.includes("Wheel")&&!k.some((e=>s.name.startsWith(e)))&&e.push(s)})),a.current=e}),[t]),s((({clock:e,camera:s})=>{const t=2*e.getElapsedTime();for(const r of a.current)r.rotation.x=s.position.x>=0?t:-t}))},C=e=>{const{scene:s}=h(v);return T(s),t.jsx("primitive",{object:s})};m.isIOS&&h.preload(v);const I="/assets/Corvette-optimized-Iz5Fnz6w.glb",L=e=>{const{scene:s}=h(I,void 0,void 0,m.extendGLTF);return T(s,130),t.jsx("primitive",{object:s})};m.isIOS||h.preload(I,void 0,void 0,m.extendGLTF);const R=e=>m.isIOS?t.jsx(C,{}):t.jsx(L,{}),F="/assets/grid-texture-eDqRcyO2.png",D=r=>{const a=e.useCallback((e=>{u.wrap(e).repeat(e,30).rerender(e),e.anisotropy=4}),[]),o=p(F,a);return s((({clock:e})=>{o.offset.set(0,.68*-e.getElapsedTime())})),t.jsxs("mesh",{"rotation-x":.5*-Math.PI,position:[0,.015,0],children:[t.jsx("planeGeometry",{args:[35,35]}),t.jsx("meshBasicMaterial",{transparent:!0,map:o,alphaMap:o,opacity:.25,color:[1,1,1]})]})};p.preload(F);const A="/assets/ground-normal-C6tMtRR7.jpg",G="/assets/ground-roughness-3HiC32xa.jpg",O=r=>{const a=e.useCallback((e=>u.wrap(e).repeat(e,5).colorless(e).rerender(e)),[]),o=e.useCallback((e=>u.wrap(e).repeat(e,5).rerender(e)),[]),n=p(A,a),i=p(G,o);return s((({clock:e})=>{const s=-.128*e.getElapsedTime();n.offset.set(0,s),i.offset.set(0,s)})),t.jsxs("mesh",{castShadow:!0,receiveShadow:!0,"rotation-x":.5*-Math.PI,children:[t.jsx("planeGeometry",{args:[30,30]}),t.jsx(d,{dithering:!0,normalMap:n,roughnessMap:i,envMapIntensity:0,normalScale:[1,1],color:[.015,.015,.015],roughness:.7,blur:[1e3,400],mixBlur:30,mixStrength:80,mixContrast:1,resolution:1024,mirror:0,depthScale:.01,minDepthThreshold:.9,maxDepthThreshold:1,depthToBlurRatioBias:.25,reflectorOffset:.2})]})};p.preload([A,G]);const z=new l(6,.16,.7).multiplyScalar(.5),B=new l(.1,.7,3).multiplyScalar(.5),P=({total:r=14})=>{const a=e.useRef([]),o=e.useMemo((()=>[0,0,0]),[]),n=e.useMemo((()=>[0,0,0]),[]),i=e.useMemo((()=>[.5,.5,.5]),[]),c=e.useMemo((()=>[3.35,.05,16,100]),[]),l=e.useMemo((()=>new Array(r).fill(null)),[r]),m=e.useCallback((e=>s=>{a.current[e]=s}),[]);return s((({clock:e})=>{let s=-1;const t=e.getElapsedTime();for(const o of a.current){if(s++,!o)continue;const e=3.5*(s-r/2)+.4*t%3.5*2;o.position.set(0,0,-e);const a=Math.abs(e),n=1-.04*a;o.scale.set(n,n,n);const i=(s%2==0?B:z).clone();let c=1;a>2&&(c=1-(Math.min(12,a)-2)/10),c*=.5,i.multiplyScalar(c),E.forEachMaterial(o.material,(e=>{e.emissive=i}))}})),t.jsx(e.Fragment,{children:l.map(((e,s)=>{const r=m(s);return t.jsxs("mesh",{ref:r,castShadow:!0,receiveShadow:!0,position:n,children:[t.jsx("torusGeometry",{args:c}),t.jsx("meshStandardMaterial",{emissive:i,color:o})]},s)}))})},q=s=>{const a=r((e=>e.camera)),[i,c]=o(n),l=e.useMemo((()=>Math.max(i,c)),[i,c]);return e.useEffect((()=>{a.position.x=Math.max(5,50-l/20)}),[l,a]),t.jsxs(e.Fragment,{children:[t.jsx(x,{target:[0,.35,0],maxPolarAngle:1.45,maxZoom:-5,minDistance:5,maxDistance:50}),t.jsx(f,{makeDefault:!0,fov:50,position:[3,2,5]}),t.jsx("color",{args:[0,0,0],attach:"background"}),t.jsx("spotLight",{castShadow:!0,color:[1,.25,.7],intensity:10.5,angle:.6,decay:.5,penumbra:.5,position:[5,5,0],"shadow-bias":-1e-4}),t.jsx("spotLight",{castShadow:!0,color:[.14,.5,1],intensity:20,angle:.6,decay:.5,penumbra:.5,position:[-5,5,0],"shadow-bias":-1e-4}),t.jsx(j,{resolution:256,frames:1/0,children:s=>t.jsxs(e.Fragment,{children:[t.jsx(M,{map:s,environmentIntensity:15}),t.jsx(R,{})]})}),t.jsx(P,{}),t.jsx(b,{}),t.jsx(D,{}),t.jsx(O,{})]})},W=e=>t.jsx(a,{children:t.jsx(q,{})});export{W as CarScene};
//# sourceMappingURL=index-itKo3PdO.js.map
