import{r as e,b as s,j as t,u as r}from"./threeFiber-wgP-k_4X.js";import{L as a}from"./index-vzOxyQP1.js";import{o,p as n}from"./index-xEw5Y9WC.js";import{h as c,K as i,d as l}from"./three-71H3Suoo.js";import{u as m,a as h,M as u,O as p,P as d,C as x,E as f}from"./threeDrei-TbYxsnpq.js";import{T as j}from"./Textures-D8KxavPh.js";import"./useLabsLoader-oXrOIvOD.js";import"./threeStdLib-Ui_sxDIS.js";const M=({color:r})=>{const a=e.useRef(0),o=e.useRef(null),n=e.useRef(g()),c=e.useMemo((()=>Math.random()),[]),i=e.useMemo((()=>Math.random()),[]),l=e.useMemo((()=>.5*Math.pow(Math.random(),2)+.05),[]);return s(((e,s)=>{if(a.current+=1.2*s,!o.current)return;const{x:t,y:r,z:l}=n.current,m=l-a.current;m<-10&&(n.current=g(10*Math.random()+10),a.current=0),o.current.position.set(t,r,m),o.current.rotation.x+=c*s,o.current.rotation.y+=i*s})),t.jsxs("mesh",{castShadow:!0,ref:o,scale:l,children:[t.jsx("boxGeometry",{args:[1,1,1]}),t.jsx("meshStandardMaterial",{color:r,envMapIntensity:.15})]})};function g(e=15*(2*Math.random()-1)){const s=new c(3*(2*Math.random()-1),Math.max(.5,2.5*Math.random()+.1),e);return s.x<0?s.x-=2.5:s.x>0&&(s.x+=2.5),s}const y=[.4,.1,.1],S=[.05,.15,.4],w=({total:s=100})=>{const r=e.useMemo((()=>new Array(s).fill(null)),[s]);return t.jsx(e.Fragment,{children:r.map(((e,s)=>t.jsx(M,{color:s%2==0?y:S},s)))})};class b{static forEachMesh(e,s){e.traverse((e=>{this.isMesh(e)&&s(e)}))}static forEachMaterial(e,s){const t=Array.isArray(e)?e:[e];for(const r of t)s(r)}static isMesh(e){return e instanceof i}}const v="/assets/Corvette-L85qAWa-.glb",E=["polySurface778","polySurface491","polySurface33","polySurface262"],k=r=>{const{scene:a}=m(v),[o,n]=e.useState([]);return e.useEffect((()=>{const e=[];a.scale.set(110,110,110),a.position.set(0,0,0),b.forEachMesh(a,(s=>{s.castShadow=!0,s.receiveShadow=!0,b.forEachMaterial(s.material,(e=>{e.envMapIntensity=20})),s.name.includes("Wheel")&&!E.some((e=>s.name.startsWith(e)))&&e.push(s)})),n(e)}),[a]),s((({clock:e})=>{const s=2*e.getElapsedTime();for(const t of o)t.rotation.x=s})),t.jsx("primitive",{object:a})};m.preload(v);const C="/assets/grid-texture-eDqRcyO2.png",T=r=>{const a=e.useCallback((e=>{j.wrap(e).repeat(e,30).rerender(e),e.anisotropy=4}),[]),o=h(C,a);return s((({clock:e})=>{o.offset.set(0,.68*-e.getElapsedTime())})),t.jsxs("mesh",{"rotation-x":.5*-Math.PI,position:[0,.015,0],children:[t.jsx("planeGeometry",{args:[35,35]}),t.jsx("meshBasicMaterial",{transparent:!0,map:o,alphaMap:o,opacity:.25,color:[1,1,1]})]})};h.preload(C);const R="/assets/ground-normal-C6tMtRR7.jpg",D="/assets/ground-roughness-3HiC32xa.jpg",L=r=>{const a=e.useCallback((e=>j.wrap(e).repeat(e,5).colorless(e).rerender(e)),[]),o=e.useCallback((e=>j.wrap(e).repeat(e,5).rerender(e)),[]),n=h(R,a),c=h(D,o);return s((({clock:e})=>{const s=-.128*e.getElapsedTime();n.offset.set(0,s),c.offset.set(0,s)})),t.jsxs("mesh",{castShadow:!0,receiveShadow:!0,"rotation-x":.5*-Math.PI,children:[t.jsx("planeGeometry",{args:[30,30]}),t.jsx(u,{dithering:!0,normalMap:n,roughnessMap:c,envMapIntensity:0,normalScale:[1,1],color:[.015,.015,.015],roughness:.7,blur:[1e3,400],mixBlur:30,mixStrength:80,mixContrast:1,resolution:1024,mirror:0,depthScale:.01,minDepthThreshold:.9,maxDepthThreshold:1,depthToBlurRatioBias:.25,reflectorOffset:.2})]})};h.preload([R,D]);const A=new l(6,.16,.7).multiplyScalar(.5),I=new l(.1,.7,3).multiplyScalar(.5),F=({total:r=14})=>{const a=e.useRef([]),o=e.useMemo((()=>[0,0,0]),[]),n=e.useMemo((()=>[0,0,0]),[]),c=e.useMemo((()=>[.5,.5,.5]),[]),i=e.useMemo((()=>[3.35,.05,16,100]),[]),l=e.useMemo((()=>new Array(r).fill(null)),[r]),m=e.useCallback((e=>s=>{a.current[e]=s}),[]);return s((({clock:e})=>{let s=-1;const t=e.getElapsedTime();for(const o of a.current){if(s++,!o)continue;const e=3.5*(s-r/2)+.4*t%3.5*2;o.position.set(0,0,-e);const a=Math.abs(e),n=1-.04*a;o.scale.set(n,n,n);const c=(s%2==0?I:A).clone();let i=1;a>2&&(i=1-(Math.min(12,a)-2)/10),i*=.5,c.multiplyScalar(i),b.forEachMaterial(o.material,(e=>{e.emissive=c}))}})),t.jsx(e.Fragment,{children:l.map(((e,s)=>{const r=m(s);return t.jsxs("mesh",{ref:r,castShadow:!0,receiveShadow:!0,position:n,children:[t.jsx("torusGeometry",{args:i}),t.jsx("meshStandardMaterial",{emissive:c,color:o})]},s)}))})},B=s=>{const a=r((e=>e.camera)),[c,i]=o(n),l=e.useMemo((()=>Math.max(c,i)),[c,i]);return e.useEffect((()=>{a.position.x=Math.max(5,50-l/20)}),[l,a]),t.jsxs(e.Fragment,{children:[t.jsx(p,{target:[0,.35,0],maxPolarAngle:1.45,maxZoom:-5,minDistance:5,maxDistance:50}),t.jsx(d,{makeDefault:!0,fov:50,position:[3,2,5]}),t.jsx("color",{args:[0,0,0],attach:"background"}),t.jsx("spotLight",{castShadow:!0,color:[1,.25,.7],intensity:10.5,angle:.6,decay:.5,penumbra:.5,position:[5,5,0],"shadow-bias":-1e-4}),t.jsx("spotLight",{castShadow:!0,color:[.14,.5,1],intensity:20,angle:.6,decay:.5,penumbra:.5,position:[-5,5,0],"shadow-bias":-1e-4}),t.jsx(x,{resolution:256,frames:1/0,children:s=>t.jsxs(e.Fragment,{children:[t.jsx(f,{map:s,environmentIntensity:15}),t.jsx(k,{})]})}),t.jsx(F,{}),t.jsx(w,{}),t.jsx(T,{}),t.jsx(L,{})]})},G=e=>t.jsx(a,{children:t.jsx(B,{})});export{G as CarScene};
//# sourceMappingURL=index-PZntTJav.js.map
